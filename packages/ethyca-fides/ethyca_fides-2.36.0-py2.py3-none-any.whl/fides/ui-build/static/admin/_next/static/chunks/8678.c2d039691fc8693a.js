"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8678],{58678:function(e,r,n){n.r(r),n.d(r,{default:function(){return X}});var t=n(29549),i=n(27378),o=n(6848),s=n(51365),a=n(90849),l=n(34896),c=n(29470),u=n(5008),f=n(55732),d=n(97865),m=n(34707),h=n.n(m),p=n(21084),x=n(60530),j=n(92975),y=n(62709),g=n(16155),v=n(34090),b=n(14633),O=n(78624),C=n(9408),w=n(90089),S=n(32393),E=n(32751),z=n(30794),_=n(24246),P=["isRequired"],D=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,k=(0,S.Gp)((function(e,r){var n=e.isRequired,t=void 0!==n&&n,o=(0,w.Z)(e,P),s=o.form.values.emails,a=(0,i.useState)(""),c=a[0],u=a[1],f=function(e){e.map((function(e){return e.trim()})).filter((function(e){return function(e){return D.test(e)}(e)&&!function(e){return s.includes(e)}(e)})).forEach((function(e){return o.push(e)})),u("")};return(0,_.jsxs)(j.NI,{alignItems:"baseline",display:"inline-flex",isInvalid:!!o.form.errors[o.name],isRequired:t,children:[(0,_.jsx)(j.lX,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,_.jsxs)(l.gC,{align:"flex-start",w:"inherit",children:[(0,_.jsx)(E.II,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:function(e){u(e.target.value)},onKeyDown:function(e){["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),f([c]))},onPaste:function(e){e.preventDefault();var r=e.clipboardData.getData("text").split(",");f(r)},ref:r,size:"sm",type:"email",value:c}),(0,_.jsx)(j.J1,{children:o.form.errors[o.name]}),s.length>0&&(0,_.jsx)(l.Eq,{spacing:1,mb:3,pt:"8px",children:s.map((function(e,r){return(0,_.jsxs)(z.Vp,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,_.jsx)(z.Sn,{children:e}),(0,_.jsx)(z.SD,{onClick:function(){o.remove(r)}})]},e)}))})]})]})}));function I(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function R(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?I(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var F=b.Ry().shape({emails:b.IX(b.Z_()).when(["notify"],{is:!0,then:b.IX(b.Z_()).min(1,"Must enter at least one valid email").label("Email")}),notify:b.O7(),minErrorCount:b.Rx().required()}),q=function(){var e=(0,p.qY)(),r=e.isOpen,n=e.onOpen,o=e.onClose,a=(0,i.useState)({emails:[],notify:!1,minErrorCount:1}),u=a[0],m=a[1],b=(0,i.useRef)(null),w=(0,C.VY)(),S=w.errorAlert,E=w.successAlert,z=(0,i.useState)(!0),P=z[0],D=z[1],I=(0,s.tE)(void 0,{skip:P}).data,q=(0,s.SC)(),N=(0,d.Z)(q,1)[0],Z=function(){var e=(0,f.Z)(h().mark((function e(r,n){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setSubmitting(!0),e.next=3,N({email_addresses:r.emails,notify_after_failures:r.notify?r.minErrorCount:0});case 3:"error"in(t=e.sent)?S((0,O.e$)(t.error),"Configure alerts and notifications has failed to save due to the following:"):E("Configure alerts and notifications saved successfully."),n.setSubmitting(!1),o();case 7:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){r&&D(!1),I&&m({emails:I.email_addresses,notify:0!==I.notify_after_failures,minErrorCount:I.notify_after_failures})}),[I,r]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.sN,{onClick:n,_focus:{bg:"gray.100",color:"complimentary.500"},children:"Configure alerts"}),(0,_.jsx)(v.J9,{enableReinitialize:!0,initialValues:u,onSubmit:Z,validationSchema:F,children:function(e){return(0,_.jsxs)(x.dy,{isOpen:r,placement:"right",initialFocusRef:b,onClose:function(){e.resetForm(),o()},size:"lg",children:[(0,_.jsx)(x.P1,{}),(0,_.jsxs)(x.sc,{color:"gray.900",children:[(0,_.jsx)(x.cC,{}),(0,_.jsxs)(x.OX,{color:"gray.900",children:[(0,_.jsx)(l.xv,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,_.jsx)(l.xu,{mt:"26px",children:(0,_.jsx)(l.xv,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,_.jsx)(x.Ng,{mt:"20px",children:(0,_.jsxs)(v.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,_.jsx)(l.xv,{fontSize:"md",children:"Contact details"}),(0,_.jsxs)(l.gC,{align:"stretch",gap:"29px",mt:"14px",children:[(0,_.jsx)(l.Ug,{children:(0,_.jsx)(v.F2,{name:"emails",render:function(r){return(0,_.jsx)(k,R(R({},r),{},{isRequired:e.values.notify,ref:b}))}})}),(0,_.jsx)(l.Ug,{children:(0,_.jsx)(v.gN,{id:"notify",name:"notify",children:function(r){var n=r.field;return(0,_.jsxs)(j.NI,{alignItems:"center",display:"flex",mt:"45px",children:[(0,_.jsx)(j.lX,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,_.jsx)(y.r,R(R({},n),{},{colorScheme:"secondary",isChecked:e.values.notify,onChange:function(r){n.onChange(r),e.setFieldValue("minErrorCount",1),r.target.checked||setTimeout((function(){e.setFieldTouched("emails",!1)}),0)}}))]})}})})]}),(0,_.jsx)(l.xv,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),e.values.notify&&(0,_.jsx)(l.Ug,{mt:"34px",children:(0,_.jsx)(v.gN,{id:"minErrorCount",name:"minErrorCount",children:function(r){var n=r.field,t=r.meta;return(0,_.jsxs)(j.NI,{alignItems:"center",display:"flex",isInvalid:!(!t.error||!t.touched),isRequired:!0,children:[(0,_.jsx)(l.xv,{children:"Notify me after"}),(0,_.jsxs)(g.Y2,{allowMouseWheel:!0,color:"gray.700",defaultValue:e.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:function(r,n){e.setFieldValue("minErrorCount",n)},size:"sm",w:"80px",children:[(0,_.jsx)(g.zu,R({},n)),(0,_.jsxs)(g.Fi,{children:[(0,_.jsx)(g.WQ,{}),(0,_.jsx)(g.Y_,{})]})]}),(0,_.jsx)(l.xv,{children:"DSR processing errors "})]})}})})]})}),(0,_.jsx)(x.ze,{justifyContent:"flex-start",children:(0,_.jsxs)(t.hE,{size:"sm",spacing:"8px",variant:"outline",children:[(0,_.jsx)(t.zx,{onClick:function(){e.resetForm(),o()},variant:"outline",children:"Cancel"}),(0,_.jsx)(t.zx,{bg:"primary.800",color:"white",form:"configure-alerts-form",isDisabled:e.isSubmitting,isLoading:e.isSubmitting,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Save"})]})})]})]})}})]})};function N(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function Z(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?N(Object(n),!0).forEach((function(r){(0,a.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var V=function(e){var r=e.menuProps;return(0,_.jsx)(l.xu,{children:(0,_.jsxs)(c.v2,Z(Z({},r),{},{children:[(0,_.jsx)(c.j2,{as:t.zx,fontWeight:"normal",rightIcon:(0,_.jsx)(u.mC,{}),size:"sm",variant:"outline",_active:{bg:"none"},_hover:{bg:"none"},children:"More"}),(0,_.jsx)(c.qy,{fontSize:"sm",children:(0,_.jsx)(q,{})})]}))})},T=n(30199),X=function(){var e=(0,o.C)(s.fe).errorRequests;return(0,_.jsxs)(t.hE,{flexDirection:"row",size:"sm",spacing:"8px",variant:"outline",children:[(null===e||void 0===e?void 0:e.length)>0&&(0,_.jsx)(T.Z,{}),(0,_.jsx)(V,{})]})}}}]);