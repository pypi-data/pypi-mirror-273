(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8593],{9408:function(e,i,t){"use strict";t.d(i,{HK:function(){return s},VY:function(){return n.V},O3:function(){return o}});var n=t(36653),r=t(78624),s=function(){var e=(0,n.V)().errorAlert;return{handleError:function(i){var t="An unexpected error occurred. Please try again.";(0,r.Ot)(i)?t=i.data.detail:(0,r.tB)(i)&&(t=i.data.detail[0].msg),e(t)}}},a=t(27378),o=function(e){var i=(0,a.useRef)(void 0);return(0,a.useEffect)((function(){var t=function(t){var n;null!==(n=i.current)&&void 0!==n&&n.contains(t.target)||e()};return document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}}),[i,e]),{ref:i}}},36653:function(e,i,t){"use strict";t.d(i,{V:function(){return d}});var n=t(90849),r=t(70409),s=t(23286),a=t(34896),o=t(93235),c=t(24246);function l(e,i){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),t.push.apply(t,n)}return t}function u(e){for(var i=1;i<arguments.length;i++){var t=null!=arguments[i]?arguments[i]:{};i%2?l(Object(t),!0).forEach((function(i){(0,n.Z)(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}))}return e}var d=function(){var e=(0,r.pm)();return{errorAlert:function(i,t,n){var r=u(u({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(s.bZ,{alignItems:"normal",status:"error",children:[(0,c.jsx)(s.zM,{}),(0,c.jsxs)(a.xu,{children:[t&&(0,c.jsx)(s.Cd,{children:t}),(0,c.jsx)(s.X,{children:i})]}),(0,c.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,r):e(r)},successAlert:function(i,t,n){var r=u(u({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(s.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,c.jsx)(s.zM,{}),(0,c.jsxs)(a.xu,{children:[t&&(0,c.jsx)(s.Cd,{children:t}),(0,c.jsx)(s.X,{children:i})]}),(0,c.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,r):e(r)}}}},56069:function(e,i,t){"use strict";t.d(i,{R:function(){return h}});var n=t(90849),r=t(90089),s=t(34896),a=t(29549),o=t(73452),c=t(79894),l=t.n(c),u=t(24246),d=["backPath"],m=["onClick"];function p(e,i){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var t=null!=arguments[i]?arguments[i]:{};i%2?p(Object(t),!0).forEach((function(i){(0,n.Z)(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}))}return e}var h=function(e){var i=e.onClick,t=(0,r.Z)(e,m);return(0,u.jsxs)(s.kC,f(f({alignItems:"center",mt:-4,mb:3,onClick:i,cursor:"pointer"},t),{},{children:[(0,u.jsx)(a.hU,{"aria-label":"Back",icon:(0,u.jsx)(o.Rp,{}),mr:2,size:"xs",variant:"outline"}),(0,u.jsx)(s.xv,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]}))};i.Z=function(e){var i=e.backPath,t=(0,r.Z)(e,d);return(0,u.jsxs)(s.kC,f(f({alignItems:"center",mb:6},t),{},{children:[(0,u.jsx)(l(),{href:i,passHref:!0,children:(0,u.jsx)(a.hU,{"aria-label":"Back",icon:(0,u.jsx)(o.Rp,{}),mr:2,size:"xs",variant:"outline"})}),(0,u.jsx)(l(),{href:i,passHref:!0,children:(0,u.jsx)(s.xv,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},24330:function(e,i,t){"use strict";t.d(i,{DE:function(){return s},MP:function(){return n},qX:function(){return r}});var n=new Map([["Approved","approved"],["Canceled","canceled"],["Completed","complete"],["Denied","denied"],["Error","error"],["In Progress","in_processing"],["New","pending"],["Paused","paused"],["Unverified","identity_unverified"],["Requires input","requires_input"]]),r={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},s={local:"local",s3:"s3"}},81946:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return q}});var n=t(55732),r=t(97865),s=t(34707),a=t.n(s),o=t(34896),c=t(73772),l=t(27378),u=t(78624),d=t(9408),m=t(51471),p=t(56069),f=t(60709),h=t(24330),x=t(51365),v=t(29549),j=t(34090),g=t(43139),y=t(24246),b=function(e){var i=e.messagingDetails,t=(0,d.VY)().successAlert,s=(0,d.HK)().handleError,c=(0,x.SU)(),l=(0,r.Z)(c,1)[0],m=i.service_type===h.qX.twilio_email||i.service_type===h.qX.mailgun,p=i.service_type===h.qX.twilio_text,f=function(){var e=(0,n.Z)(a().mark((function e(i){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=5;break}return e.next=3,l({email:i.email});case 3:n=e.sent,(0,u.D4)(n)?s(n.error):t("Test message successfully sent.");case 5:if(!p){e.next=10;break}return e.next=8,l({phone_number:i.phone});case 8:r=e.sent,(0,u.D4)(r)?s(r.error):t("Test message successfully sent.");case 10:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.iz,{mt:10}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,mb:5,children:"Test connection"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:{email:"",phone:""},onSubmit:f,children:function(e){var i=e.isSubmitting,t=e.resetForm;return(0,y.jsxs)(j.l0,{children:[m?(0,y.jsx)(g.j0,{name:"email",label:"Email",placeholder:"youremail@domain.com",isRequired:!0}):null,p?(0,y.jsx)(g.j0,{name:"phone",label:"Phone",placeholder:"+10000000000",isRequired:!0}):null,(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return t()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})})]})},_=function(){var e,i=(0,d.VY)().successAlert,t=(0,l.useState)(""),s=t[0],c=t[1],m=(0,d.HK)().handleError,p=(0,x.S3)({type:h.qX.mailgun}).data,f=(0,x.h9)(),_=(0,r.Z)(f,1)[0],w=(0,x.iI)(),k=(0,r.Z)(w,1)[0],S=function(){var e=(0,n.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({service_type:h.qX.mailgun,details:{is_eu_domain:"false",domain:t.domain}});case 2:n=e.sent,(0,u.D4)(n)?m(n.error):(i("Mailgun email successfully updated. You can now enter your security key."),c("apiKey"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),q=function(){var e=(0,n.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({details:{mailgun_api_key:t.api_key},service_type:h.qX.mailgun});case 2:n=e.sent,(0,u.D4)(n)?m(n.error):(i("Mailgun security key successfully updated."),c("testConnection"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),z={domain:null!==(e=null===p||void 0===p?void 0:p.details.domain)&&void 0!==e?e:""};return(0,y.jsxs)(o.xu,{children:[(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Mailgun messaging configuration"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:z,onSubmit:S,enableReinitialize:!0,children:function(e){var i=e.isSubmitting,t=e.handleReset;return(0,y.jsxs)(j.l0,{children:[(0,y.jsx)(o.Kq,{mt:5,spacing:5,children:(0,y.jsx)(g.j0,{name:"domain",label:"Domain",placeholder:"Enter domain","data-testid":"option-twilio-domain",isRequired:!0})}),(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:t,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})}),"apiKey"===s||"testConnection"===s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.iz,{mt:10}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:{api_key:""},onSubmit:q,children:function(e){var i=e.isSubmitting,t=e.handleReset;return(0,y.jsxs)(j.l0,{children:[(0,y.jsx)(g.j0,{name:"api_key",label:"API key",type:"password",isRequired:!0}),(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:t,mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null,"testConnection"===s?(0,y.jsx)(b,{messagingDetails:p||{service_type:h.qX.mailgun}}):null]})},w=function(){var e,i=(0,l.useState)(""),t=i[0],s=i[1],c=(0,d.VY)().successAlert,m=(0,d.HK)().handleError,p=(0,x.S3)({type:h.qX.twilio_email}).data,f=(0,x.h9)(),_=(0,r.Z)(f,1)[0],w=(0,x.iI)(),k=(0,r.Z)(w,1)[0],S=function(){var e=(0,n.Z)(a().mark((function e(i){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({service_type:h.qX.twilio_email,details:{twilio_email_from:i.email}});case 2:t=e.sent,(0,u.D4)(t)?m(t.error):(c("Twilio email successfully updated. You can now enter your security key."),s("configureTwilioEmailSecrets"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),q=function(){var e=(0,n.Z)(a().mark((function e(i){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({details:{twilio_api_key:i.api_key},service_type:h.qX.twilio_email});case 2:t=e.sent,(0,u.D4)(t)?m(t.error):(c("Twilio email secrets successfully updated."),s("testConnection"));case 4:case"end":return e.stop()}}),e)})));return function(i){return e.apply(this,arguments)}}(),z={email:null!==(e=null===p||void 0===p?void 0:p.details.twilio_email_from)&&void 0!==e?e:""};return(0,y.jsxs)(o.xu,{children:[(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio Email messaging configuration"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:z,onSubmit:S,enableReinitialize:!0,children:function(e){var i=e.isSubmitting,t=e.handleReset;return(0,y.jsxs)(j.l0,{children:[(0,y.jsx)(o.Kq,{mt:5,spacing:5,children:(0,y.jsx)(g.j0,{name:"email",label:"Email",placeholder:"Enter email",isRequired:!0})}),(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return t()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})}),"configureTwilioEmailSecrets"===t||"testConnection"===t?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o.iz,{mt:10}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:{api_key:""},onSubmit:q,children:function(e){var i=e.isSubmitting,t=e.handleReset;return(0,y.jsxs)(j.l0,{children:[(0,y.jsx)(o.Kq,{mt:5,spacing:5,children:(0,y.jsx)(g.j0,{name:"api_key",label:"API key",type:"password",isRequired:!0})}),(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return t()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null,"testConnection"===t?(0,y.jsx)(b,{messagingDetails:p||{service_type:h.qX.twilio_email}}):null]})},k=function(){var e=(0,d.VY)().successAlert,i=(0,d.HK)().handleError,t=(0,l.useState)(""),s=t[0],c=t[1],m=(0,x.S3)({type:"twilio_text"}).data,p=(0,x.iI)(),f=(0,r.Z)(p,1)[0],_=function(){var t=(0,n.Z)(a().mark((function t(n){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f({details:{twilio_account_sid:n.account_sid,twilio_auth_token:n.auth_token,twilio_messaging_service_sid:n.messaging_service_sid,twilio_sender_phone_number:n.phone},service_type:h.qX.twilio_text});case 2:r=t.sent,(0,u.D4)(r)?i(r.error):(e("Twilio text secrets successfully updated."),c("testConnection"));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,y.jsxs)(o.xu,{children:[(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio SMS messaging configuration"}),(0,y.jsx)(o.Kq,{children:(0,y.jsx)(j.J9,{initialValues:{account_sid:"",auth_token:"",messaging_service_sid:"",phone:""},onSubmit:_,enableReinitialize:!0,children:function(e){var i=e.isSubmitting,t=e.handleReset;return(0,y.jsxs)(j.l0,{children:[(0,y.jsxs)(o.Kq,{mt:5,spacing:5,children:[(0,y.jsx)(g.j0,{name:"account_sid",label:"Account SID",placeholder:"Enter account SID",isRequired:!0}),(0,y.jsx)(g.j0,{name:"auth_token",label:"Auth token",placeholder:"Enter auth token",type:"password",isRequired:!0}),(0,y.jsx)(g.j0,{name:"messaging_service_sid",label:"Messaging Service SID",placeholder:"Enter messaging service SID"}),(0,y.jsx)(g.j0,{name:"phone",label:"Phone Number",placeholder:"Enter phone number"})]}),(0,y.jsxs)(o.xu,{mt:10,children:[(0,y.jsx)(v.zx,{onClick:function(){return t()},mr:2,size:"sm",variant:"outline",children:"Cancel"}),(0,y.jsx)(v.zx,{isDisabled:i,type:"submit",colorScheme:"primary",size:"sm","data-testid":"save-btn",children:"Save"})]})]})}})}),"testConnection"===s?(0,y.jsx)(b,{messagingDetails:m||{service_type:h.qX.twilio_text}}):null]})},S=function(){var e=(0,d.VY)().successAlert,i=(0,d.HK)().handleError,t=(0,l.useState)(""),s=t[0],v=t[1],j=(0,x.h9)(),g=(0,r.Z)(j,1)[0],b=(0,x.L)(),S=(0,r.Z)(b,1)[0],q=(0,x.JE)().data;(0,l.useEffect)((function(){q&&v(null===q||void 0===q?void 0:q.service_type)}),[q]);var z=function(){var t=(0,n.Z)(a().mark((function t(n){var r,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S({notifications:{notification_service_type:n,send_request_completion_notification:!0,send_request_receipt_notification:!0,send_request_review_notification:!0},execution:{subject_identity_verification_required:!0}});case 2:if(r=t.sent,!(0,u.D4)(r)){t.next=7;break}i(r.error),t.next=15;break;case 7:if(n===h.qX.twilio_text){t.next=11;break}v(n),t.next=15;break;case 11:return t.next=13,g({service_type:h.qX.twilio_text});case 13:s=t.sent,(0,u.D4)(s)?i(s.error):(e("Messaging provider saved successfully."),v(n));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,y.jsxs)(m.Z,{title:"Configure Privacy Requests - Messaging",children:[(0,y.jsx)(p.Z,{backPath:f.fz}),(0,y.jsx)(o.X6,{mb:5,fontSize:"2xl",fontWeight:"semibold",children:"Configure your messaging provider"}),(0,y.jsxs)(o.xu,{display:"flex",flexDirection:"column",width:"50%",children:[(0,y.jsxs)(o.xu,{children:["Fides requires a messsaging provider for sending processing notices to privacy request subjects, and allows for Subject Identity Verification in privacy requests. Please follow the"," ",(0,y.jsx)(o.xv,{as:"span",color:"complimentary.500",children:"documentation"})," ","to setup a messaging service that Fides supports. Ensure you have completed the setup for the preferred messaging provider and have the details handy prior to the following steps."]}),(0,y.jsx)(o.X6,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose service type to configure"}),(0,y.jsx)(c.Ee,{onChange:z,value:s,"data-testid":"privacy-requests-messaging-provider-selection",colorScheme:"secondary",p:3,children:(0,y.jsxs)(o.Kq,{direction:"row",children:[(0,y.jsx)(c.Y8,{value:h.qX.mailgun,"data-testid":"option-mailgun",mr:5,children:"Mailgun Email"},h.qX.mailgun),(0,y.jsx)(c.Y8,{value:h.qX.twilio_email,"data-testid":"option-twilio-email",children:"Twilio Email"},h.qX.twilio_email),(0,y.jsx)(c.Y8,{value:h.qX.twilio_text,"data-testid":"option-twilio-sms",children:"Twilio SMS"},h.qX.twilio_text)]})}),s===h.qX.mailgun?(0,y.jsx)(_,{}):null,s===h.qX.twilio_email?(0,y.jsx)(w,{}):null,s===h.qX.twilio_text?(0,y.jsx)(k,{}):null]})]})},q=function(){return(0,y.jsx)(S,{})}},13687:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/messaging",function(){return t(81946)}])},30808:function(e,i,t){"use strict";function n(e,i){if(null==e)return{};var t,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],i.indexOf(t)>=0||(r[t]=e[t]);return r}t.d(i,{Z:function(){return n}})},6983:function(e,i,t){"use strict";function n(e,i){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},n(e,i)}t.d(i,{Z:function(){return n}})}},function(e){e.O(0,[7751,3452,6842,1081,338,3702,9774,2888,179],(function(){return i=13687,e(e.s=i);var i}));var i=e.O();_N_E=i}]);