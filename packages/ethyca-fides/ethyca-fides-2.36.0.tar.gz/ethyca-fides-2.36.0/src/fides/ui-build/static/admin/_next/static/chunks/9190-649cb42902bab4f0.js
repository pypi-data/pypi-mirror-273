"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9190],{86054:function(e,n,t){var i=t(90849),a=t(90089),r=t(34896),s=t(38687),l=t(24246),o=["title","tooltip","children"];function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.title,t=e.tooltip,i=e.children,c=(0,a.Z)(e,o);return(0,l.jsxs)(r.xu,u(u({borderRadius:"md",border:"1px solid",borderColor:"gray.200"},c),{},{children:[(0,l.jsxs)(r.X6,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,t?(0,l.jsx)(r.xv,{as:"span",mx:1,children:(0,l.jsx)(s.Z,{label:t})}):void 0]}),(0,l.jsx)(r.Kq,{p:6,spacing:6,children:i})]}))}},59190:function(e,n,t){t.d(n,{Z:function(){return $}});var i=t(55732),a=t(97865),r=t(90849),s=t(34707),l=t.n(s),o=t(34896),c=t(92975),u=t(70409),d=t(29549),f=t(58981),p=t(34090),g=t(86677),v=t(27378),m=t(6848),h=t(86054),b=t(43139),j=t(78624),x=t(60709),y=t(64429),O=t(38687),_=t(24753),w=t(75846),P=t(73679),k=t(20294),C=t(73452),Z=t(49601),S=t(83026),D=t(89403),z=t(24246),E=function(e){var n=e.index;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(b.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of consent notice as displayed to user",variant:"stacked"}),(0,z.jsx)(b.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},N=function(e){var n=e.index,t=e.name,i=e.isOOB;return(0,z.jsxs)(o.kC,{direction:"column",gap:6,children:[(0,z.jsxs)(o.X6,{size:"sm",children:["Edit ",t," translation"]}),i?(0,z.jsx)(S.f,{languageName:t}):null,(0,z.jsx)(E,{index:n})]})},T=function(e){var n=e.translation,t=e.name,i=e.onLanguageDeleted;return(0,z.jsxs)(o.kC,{gap:2,direction:"row",w:"100%",children:[(0,z.jsx)(k.OK,{as:d.zx,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:t},n.language),i?(0,z.jsx)(d.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:function(){return i(n.language)},children:(0,z.jsx)(C.pJ,{boxSize:4})}):null]})},R=function(e){var n,t=e.availableTranslations,i=(0,p.u6)(),a=i.values,r=i.setFieldValue,s=(0,v.useState)(!1),l=s[0],c=s[1],u=(0,v.useState)(!1),g=u[0],j=u[1],x=(0,v.useState)(0),y=x[0],O=x[1],_=(0,D.tB)({api_set:!1}).data,w=null===_||void 0===_||null===(n=_.plus_consent_settings)||void 0===n?void 0:n.enable_translations,S=(0,m.C)(Z.Zp),R=(0,m.C)(Z.G1);(0,Z.Ah)({page:S,size:R});var q=(0,m.C)(Z.fJ).slice().sort((function(e,n){return e.name.localeCompare(n.name)})),F=q.filter((function(e){var n;return null===(n=a.translations)||void 0===n?void 0:n.every((function(n){return n.language!==e.id}))})).map((function(e){return{label:e.name,value:e.id}})),I=function(e){var n=a.translations?a.translations.slice().filter((function(n){return n.language!==e})):[],t=y===n.length?n.length-1:y;r("translations",n),O(t)},J=function(e){var n,t;return null!==(n=null===(t=q.find((function(n){return n.id===e})))||void 0===t?void 0:t.name)&&void 0!==n?n:e};return w?(0,z.jsx)(h.Z,{title:"Localizations",children:(0,z.jsxs)(k.mQ,{index:y,onChange:function(e){O(e),j(!1)},as:o.Ug,spacing:8,align:"start",grow:1,w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,z.jsxs)(o.gC,{spacing:4,minW:"30%",p:2,children:[(0,z.jsx)(k.td,{w:"100%",children:(0,z.jsx)(o.gC,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:a.translations.map((function(e){return(0,z.jsx)(T,{translation:e,name:J(e.language),onLanguageDeleted:I},e.language)}))})}),l?(0,z.jsx)(o.xu,{w:"full","data-testid":"select-language",children:(0,z.jsx)(f.Z,{chakraStyles:b.hP,size:"sm",options:F,onChange:function(e){return function(e){var n=null===t||void 0===t?void 0:t.find((function(n){return n.language===e}));j(!!n);var i=null!==n&&void 0!==n?n:{language:e,title:"",description:""};O(a.translations.length),r("translations",[].concat((0,P.Z)(a.translations),[i])),c(!1)}(e.value)},autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!l&&F.length?(0,z.jsx)(d.zx,{leftIcon:(0,z.jsx)(C.jB,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:function(){return c(!0)},"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,z.jsx)(o.xu,{w:"100%",children:(0,z.jsx)(p.F2,{name:"translations",render:function(){return(0,z.jsx)(k.nP,{w:"100%",children:a.translations.map((function(e,n){return(0,z.jsx)(k.x4,{children:(0,z.jsx)(N,{index:n,name:J(e.language),isOOB:g})},e.language)}))})}})})]})}):(0,z.jsx)(h.Z,{title:"Notice text",children:(0,z.jsx)(E,{index:0})})},q=t(90089),F=t(14633),I=t(288),J=["privacy_notice_history_id"];function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var V=[{label:"Opt in",value:I.J7.OPT_IN},{label:"Opt out",value:I.J7.OPT_OUT},{label:"Notice only",value:I.J7.NOTICE_ONLY}],A=[{language:I.eU.EN,title:"",description:""}],B={name:"",consent_mechanism:I.J7.OPT_IN,data_uses:[],enforcement_level:I.QT.SYSTEM_WIDE,disabled:!0,translations:A},M=F.Ry().shape({name:F.Z_().required().label("Title"),consent_mechanism:F.Z_().required().label("Consent mechanism")}),U=t(14441),W=t.n(U),X=function(e){var n=e.isEditing,t=(0,p.u6)(),i=t.values,a=t.setFieldValue;return(0,v.useEffect)((function(){if(!n){var e=W()(i.name);a("notice_key",e)}}),[i.name,n,a]),(0,z.jsx)(b.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},G=t(15749);function Q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var H=function(e){var n,t=e.regions,i=e.label,a=e.tooltip;return(0,z.jsxs)(o.gC,{align:"start",children:[(0,z.jsxs)(o.kC,{align:"start",children:[i?(0,z.jsx)(c.lX,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:i}):null,a?(0,z.jsx)(O.Z,{label:a}):null]}),(0,z.jsx)(o.xu,{w:"100%","data-testid":"notice-locations",children:(0,z.jsx)(f.Z,{chakraStyles:Y(Y({},b.hP),{},{dropdownIndicator:function(e){return Y(Y({},e),{},{display:"none"})},multiValueRemove:function(e){return Y(Y({},e),{},{display:"none"})}}),classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(n=null===t||void 0===t?void 0:t.map((function(e){return{label:y.Z8[e],value:e}})))&&void 0!==n?n:[]})})]})},$=function(e){var n=e.privacyNotice,t=e.availableTranslations,r=(0,g.useRouter)(),s=(0,u.pm)(),c=n?function(e){var n,t,i,a;return{name:null!==(n=e.name)&&void 0!==n?n:B.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:B.consent_mechanism,data_uses:null!==(i=e.data_uses)&&void 0!==i?i:B.data_uses,enforcement_level:null!==(a=e.enforcement_level)&&void 0!==a?a:B.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map((function(e){var n;return e.privacy_notice_history_id,K(K({},(0,q.Z)(e,J)),{},{title:null!==(n=e.title)&&void 0!==n?n:""})})):A}}(n):B;(0,w.fd)();var f=(0,m.C)(w.qv),y=(0,G.vL)(),O=(0,a.Z)(y,1)[0],P=(0,G.p4)(),k=(0,a.Z)(P,1)[0],C=(0,v.useMemo)((function(){return!!n}),[n]),Z=function(){var e=(0,i.Z)(l().mark((function e(t){var i,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=7;break}return o=Y(Y({},t),{},{id:n.id,enforcement_level:n.enforcement_level,translations:null!==(a=t.translations)&&void 0!==a?a:[]}),e.next=4,O(o);case 4:i=e.sent,e.next=10;break;case 7:return e.next=9,k(t);case 9:i=e.sent;case 10:(0,j.D4)(i)?s((0,_.Vo)((0,j.e$)(i.error))):(s((0,_.t5)("Privacy notice ".concat(C?"updated":"created"))),C||r.push(x.IT));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,z.jsx)(p.J9,{initialValues:c,enableReinitialize:!0,onSubmit:Z,validationSchema:M,children:function(e){var i=e.dirty,a=e.isValid,s=e.isSubmitting;return(0,z.jsx)(p.l0,{children:(0,z.jsxs)(o.Kq,{spacing:10,children:[(0,z.jsxs)(o.Kq,{spacing:6,children:[(0,z.jsxs)(h.Z,{title:"Privacy notice details",children:[(0,z.jsx)(b.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,z.jsx)(b.AP,{name:"consent_mechanism",label:"Consent mechanism",options:V,isRequired:!0,variant:"stacked"}),(0,z.jsx)(X,{isEditing:C}),(0,z.jsx)(H,{regions:null===n||void 0===n?void 0:n.configured_regions,label:"Locations where consent notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,z.jsx)(b.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,z.jsx)(b.AP,{name:"data_uses",label:"Data use",options:f,isMulti:!0,variant:"stacked"})]}),(0,z.jsx)(R,{availableTranslations:t})]}),(0,z.jsxs)(d.hE,{size:"sm",spacing:2,children:[(0,z.jsx)(d.zx,{variant:"outline",onClick:function(){r.back()},children:"Cancel"}),(0,z.jsx)(d.zx,{type:"submit",variant:"primary",size:"sm",isDisabled:s||!i||!a,isLoading:s,"data-testid":"save-btn",children:"Save"})]})]})})}})}}}]);