"use strict";(self.webpackChunkjupyterlab_new_launcher=self.webpackChunkjupyterlab_new_launcher||[]).push([[787],{787:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var a=n(626),s=n(923),o=n(670),r=n(260),l=n(825),i=n(265),c=n(527),d=n(53),m=n(345),u=n.n(m);const h=new c.LabIcon({name:"jupyterlab-new-launcher:star",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n  <path class="jp-icon3 jp-star-filled" fill="rgb(97,97,97)" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" />\n  <path class="jp-icon3 jp-star-border" fill="rgb(97,97,97)" d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z" />\n</svg>\n'}),p=new c.LabIcon({name:"jupyterlab-new-launcher:file",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n  <path class="jp-icon3" fill="rgb(97,97,97)" d="M13.81 22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H14L20 8V13.09C19.67 13.04 19.34 13 19 13S18.33 13.04 18 13.09V9H13V4H6V20H13.09C13.21 20.72 13.46 21.39 13.81 22M23 18H20V15H18V18H15V20H18V23H20V20H23V18Z" />\n</svg>'}),g=new c.LabIcon({name:"jupyterlab-new-launcher:code-server",svgstr:'<svg width="64" viewBox="0 0 2250 2250" version="1.1" xmlns="http://www.w3.org/2000/svg" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">\n<g class="jp-icon0" fill="#000" style="fill-rule:nonzero;">\n  <path d="M1991.66,1034.72c-38.493,0 -64.144,-22.57 -64.144,-68.897l-0,-266.084c-0,-169.867 -69.982,-263.709 -250.762,-263.709l-83.976,0l-0,179.368l25.661,0c71.144,0 104.967,39.201 104.967,109.285l0,235.201c0,102.156 30.324,143.733 96.806,165.114c-66.482,20.196 -96.806,62.958 -96.806,165.114l0,174.621c0,48.7 0,96.216 -12.829,144.917c-12.829,45.141 -33.823,87.903 -62.98,124.726c-16.329,21.386 -34.991,39.202 -55.981,55.835l-0,23.755l83.971,-0c180.781,-0 250.763,-93.843 250.763,-263.709l-0,-266.084c-0,-47.516 24.485,-68.897 64.144,-68.897l47.822,-0l-0,-179.37l-46.656,-0l0,-1.186Z"/>\n  <path d="M1420.16,706.904l-258.923,0c-5.833,0 -10.495,-4.752 -10.495,-10.691l-0,-20.192c-0,-5.941 4.662,-10.692 10.495,-10.692l260.089,0c5.83,0 10.495,4.751 10.495,10.692l0,20.192c0,5.939 -5.833,10.691 -11.661,10.691Z" />\n  <path d="M1464.48,963.474l-188.942,0c-5.833,0 -10.501,-4.754 -10.501,-10.693l0,-20.192c0,-5.938 4.668,-10.691 10.501,-10.691l188.942,-0c5.833,-0 10.495,4.753 10.495,10.691l-0,20.192c-0,4.754 -4.662,10.693 -10.495,10.693Z"/>\n  <path d="M1539.12,835.188l-377.885,0c-5.833,0 -10.495,-4.75 -10.495,-10.689l-0,-20.196c-0,-5.939 4.662,-10.69 10.495,-10.69l376.719,0c5.833,0 10.499,4.751 10.499,10.69l-0,20.196c-0,4.75 -3.5,10.689 -9.333,10.689Z"/>\n  <path d="M861.493,765.074c25.658,0 51.319,2.376 75.811,8.316l0,-48.705c0,-68.897 34.989,-109.285 104.971,-109.285l25.658,0l-0,-179.368l-83.977,0c-180.781,0 -250.758,93.842 -250.758,263.709l0,87.901c40.819,-14.252 83.977,-22.568 128.295,-22.568Z"/>\n  <path d="M1618.44,1411.25c-18.662,-150.861 -132.962,-276.776 -279.919,-305.285c-40.818,-8.314 -81.642,-9.504 -121.295,-2.376c-1.166,-0 -1.166,-1.189 -2.332,-1.189c-64.148,-136.605 -201.772,-226.884 -351.063,-226.884c-149.289,-0 -285.747,87.905 -351.062,224.51c-1.166,-0 -1.166,1.188 -2.332,1.188c-41.987,-4.753 -83.975,-2.379 -125.963,8.314c-144.623,35.634 -254.257,159.175 -274.085,308.847c-2.332,15.441 -3.499,30.883 -3.499,45.141c0,45.136 30.325,86.713 74.645,92.652c54.817,8.317 102.636,-34.448 101.469,-89.089c0,-8.317 0,-17.821 1.167,-26.134c9.331,-76.025 66.48,-140.168 141.123,-157.99c23.328,-5.939 46.654,-7.124 68.814,-3.559c71.146,9.502 141.124,-27.324 171.449,-91.467c22.162,-47.516 57.151,-89.094 103.804,-111.664c51.314,-24.946 109.633,-28.506 163.286,-9.499c55.979,20.192 97.966,62.954 123.627,116.409c26.824,52.27 39.653,89.093 96.805,96.221c23.325,3.559 88.639,2.374 113.132,1.185c47.82,0 95.64,16.631 129.463,51.079c22.156,23.757 38.485,53.455 45.486,86.715c10.495,53.455 -2.334,106.908 -33.825,147.296c-22.162,28.509 -52.485,49.89 -86.308,59.394c-16.329,4.754 -32.657,5.939 -48.986,5.939l-257.757,0c-51.314,0 -92.138,-41.573 -92.138,-93.842l0,-348.049c0,-14.251 -11.661,-26.13 -25.658,-26.13l-36.156,0c-71.148,1.185 -128.295,81.964 -128.295,167.488l-0,312.415c-0,92.652 73.476,167.488 164.451,167.488c0,0 404.714,-1.19 410.544,-1.19c93.304,-9.503 179.614,-58.204 237.927,-133.04c58.319,-72.46 85.142,-167.492 73.481,-264.894Z"/>\n</g></svg>'});var v=n(602);class f{constructor(e){var t,n,a,s,o;this._options=e,this._refreshLastUsed=new v.Signal(this),this._refreshClock=null,this._lastUsed=null;const{item:r,commands:l,lastUsedDatabase:i,favoritesDatabase:c,cwd:d}=e,m={...r.args,cwd:d};this.command=r.command,this.args=m,this.category=r.category,this.rank=r.rank,this.kernelIconUrl=r.kernelIconUrl,this.metadata=null!==(t=r.metadata)&&void 0!==t?t:{},this.iconClass=l.iconClass(r.command,m),this.icon=l.icon(r.command,m),this.caption=l.caption(r.command,m),this.label=l.label(r.command,m),this.lastUsed=i.get(r),this.starred=null!==(n=c.get(r))&&void 0!==n&&n;const u=this.metadata.kernel;if(u){const e=(null!==(a=u.conda_env_name)&&void 0!==a?a:"").match(/(?<namespace>.+)-(?<duplicate>\1)-(?<environment>.+)/);if(e&&this.metadata){const t=e.groups;this.label=null!==(s=u.conda_language)&&void 0!==s?s:t.environment,this.metadata={...this.metadata,kernel:{Namespace:t.namespace,conda_env_name:t.environment,...u}}}}"server-proxy:open"===this.command&&(null===(o=this.kernelIconUrl)||void 0===o?void 0:o.endsWith("/vscode"))&&(this.icon=g)}get lastUsed(){return this._lastUsed}set lastUsed(e){this._lastUsed=e,this._setRefreshClock()}get refreshLastUsed(){return this._refreshLastUsed}async execute(){const{item:e,commands:t,lastUsedDatabase:n}=this._options;await t.execute(e.command,this.args),await n.recordAsUsedNow(e),this.lastUsed=n.get(e),this._refreshLastUsed.emit()}async markAsUsed(){const{item:e,lastUsedDatabase:t}=this._options;await t.recordAsUsedNow(e),this.lastUsed=t.get(e),this._refreshLastUsed.emit()}toggleStar(){const{item:e,favoritesDatabase:t}=this._options,n=!t.get(e);return this.starred=n,t.set(e,n)}_setRefreshClock(){const e=this._lastUsed;if(null!==this._refreshClock&&(window.clearTimeout(this._refreshClock),this._refreshClock=null),!e)return;const t=Date.now()-e.getTime(),n=t<6e4?1e4:t<36e5?6e4:36e5;this._refreshClock=window.setTimeout((()=>{this._refreshLastUsed.emit(),this._setRefreshClock()}),n)}}var b=n(702);const _="jp-sortable-table";function w(e){const[t,n]=(0,m.useState)({sortKey:e.sortKey,sortDirection:e.sortDirection||1});let a=e.rows;const s=e.columns.filter((e=>e.id===t.sortKey))[0];if(s){const n=s.sort.bind(s);a=e.rows.sort(((e,a)=>{var s;return(null!==(s=n(e.data,a.data))&&void 0!==s?s:0)*t.sortDirection}))}const o=e.columns.filter((e=>(!e.isAvailable||e.isAvailable())&&!e.isHidden)),[r,l]=u().useState({}),i=a.map((t=>{const n=o.map((e=>u().createElement("td",{key:e.id+"-"+t.key,className:r[e.id]?"jp-mod-col-resized":""},e.renderCell(t.data))));return u().createElement("tr",{key:t.key,"data-key":t.key,onClick:e.onRowClick,className:"jp-sortable-table-tr"},n)})),c=o.map((e=>u().createElement(y,{label:e.label,id:e.id,state:t,key:e.id,onSort:()=>{var a;(a=e.id)===t.sortKey?n({sortKey:a,sortDirection:-1*t.sortDirection}):n({sortKey:a,sortDirection:1})},onResize:()=>{l({...r,[e.id]:!0})},minWidth:e.minWidth})));return u().createElement("table",{className:_},u().createElement("thead",null,u().createElement("tr",{className:"jp-sortable-table-tr"},c)),u().createElement("tbody",null,i))}function y(e){var t;const n=e.id===e.state.sortKey,a=n&&1!==e.state.sortDirection?c.caretDownIcon:c.caretUpIcon,[s,o]=u().useState(null),r=u().useRef(null),[l,i]=u().useState(!1),[d,h]=(0,m.useState)(null);requestAnimationFrame((()=>{if(r.current){const{left:e}=r.current.getBoundingClientRect();h(e)}})),u().useEffect((()=>{const t=t=>{if(l){let n;if(null===d){if(!r.current)throw Error("Cannot resize: no reference to the current table");console.warn("Resize cache for column was not available"),n=r.current.getBoundingClientRect().left}else n=d;o(t.clientX-n),e.onResize()}},n=e=>{l&&(document.body.classList.remove(v),i(!1),e.stopImmediatePropagation())};return document.body.addEventListener("pointermove",t),document.body.addEventListener("pointerup",n),()=>{document.body.removeEventListener("pointermove",t),document.body.removeEventListener("pointerup",n)}}));const p=[];n&&p.push("jp-sorted-header"),l&&p.push("jp-header-resizing");const g="jp-sortable-table-resize-handle",v="jp-mod-resize-table";return u().createElement("th",{key:e.id,ref:r,onClick:()=>e.onSort(),className:p.join(" "),"data-id":e.id,style:{width:null!==s?`${Math.max(null!==(t=e.minWidth)&&void 0!==t?t:50,s)}px`:""},onPointerDown:e=>{e.target instanceof HTMLElement&&e.target.className===g&&(document.body.classList.add(v),i(!0))}},u().createElement("div",{className:"jp-sortable-table-th-wrapper"},u().createElement("label",null,e.label),u().createElement(a.react,{tag:"span",className:"jp-sort-icon"})),u().createElement("div",{className:g}))}var C=n(262);const k="jupyterlab-new-launcher:plugin";var E;!function(e){e.create="launcher:create",e.moveColumn="new-launcher:table-move-column",e.toggleColumn="new-launcher:table-toggle-column"}(E||(E={}));const j=new C.Token("jupyterlab-new-launcher:ILauncherDatabase","Databases for new launcher."),D="jp-starIconButton",L="jp-TableKernelItem";function N(e){if(0===e.length)return"(empty)";switch(e){case"conda_env_name":return"Environment";case"conda_env_path":return"Environment path";case"conda_language":return"Language";case"conda_raw_kernel_name":return"Kernel";case"conda_is_base_environment":return"Base?";case"conda_is_currently_running":return"Running?"}return e[0].toUpperCase()+e.substring(1)}function S(e){return m.createElement("div",{className:"jp-ellipsis-wrapper",title:e.title},m.createElement("div",{className:"jp-ellipsis"},e.children))}function I(e){var t,n,a,s;const{trans:o}=e;let r,l;const[i,d]=m.useState("");e.showSearchBox?(r=i,l=d):r=e.query;const[,u]=m.useReducer((e=>e+1),0),p=new Set;for(const n of e.items){const e=null===(t=n.metadata)||void 0===t?void 0:t.kernel;if(e)for(const t of Object.keys(e))p.add(t)}const g=[...p].map((e=>({id:e,label:N(e),renderCell:t=>{var n;const a=null===(n=t.metadata)||void 0===n?void 0:n.kernel;return m.createElement(S,null,(()=>{if(!a)return"-";const t=a[e];return"string"==typeof t?t:JSON.stringify(t)})())},sort:(t,n)=>{var a,s;const o=null===(a=t.metadata)||void 0===a?void 0:a.kernel,r=null===(s=n.metadata)||void 0===s?void 0:s.kernel,l=o?o[e]:void 0,i=r?r[e]:void 0;return l===i?0:l?i?"string"==typeof l&&"string"==typeof i?l.localeCompare(i):l>i?1:-1:-1:1}})));e.showWidgetType&&g.push({id:"widget-type",label:o.__("Type"),renderCell:e=>e.command.split(":")[0],sort:(e,t)=>e.command.localeCompare(t.command)});const v=[{id:"kernel",label:o.__("Kernel"),renderCell:t=>m.createElement(S,null,m.createElement("span",{className:L,onClick:n=>{e.onClick(t),n.stopPropagation()},onKeyDown:e=>{"Enter"===e.key&&t.execute()},tabIndex:0},m.createElement("span",{className:"jp-LauncherCard-icon",onClick:()=>e.onClick(t)},t.kernelIconUrl?m.createElement("img",{src:t.kernelIconUrl,className:"jp-Launcher-kernelIcon",alt:t.label}):m.createElement("div",{className:"jp-LauncherCard-noKernelIcon"},t.label[0].toUpperCase())),m.createElement("span",{className:"jp-TableKernelItem-label"},t.label))),sort:(e,t)=>e.label.localeCompare(t.label)},...g,{id:"last-used",label:o.__("Last Used"),renderCell:e=>m.createElement(c.UseSignal,{signal:e.refreshLastUsed},(()=>m.createElement(S,{title:e.lastUsed?b.Time.format(e.lastUsed):o.__("No information about last use of this kernel is available in the layout database")},e.lastUsed?b.Time.formatHuman(e.lastUsed):o.__("Never")))),sort:(e,t)=>e.lastUsed===t.lastUsed?0:e.lastUsed?t.lastUsed&&e.lastUsed>t.lastUsed?1:-1:1},{id:"star",label:"",renderCell:e=>{const t=e.starred,n=t?o.__("Click to remove the kernel from favourites"):o.__("Click to add this kernel to favourites");return m.createElement("button",{className:t?`${D} jp-mod-starred`:D,title:n,onClick:t=>{e.toggleStar(),u(),t.stopPropagation()}},m.createElement(h.react,{className:"jp-starIcon"}))},sort:(e,t)=>Number(e.starred)-Number(t.starred)}],f=null!==(n=e.hideColumns)&&void 0!==n?n:[],_=v.filter((e=>!f.includes(e.id))),[y,C]=m.useState(null!==(a=e.settings.composite.hiddenColumns)&&void 0!==a?a:{}),k=_.map((e=>e.id)),[j,I]=m.useState(null!==(s=e.settings.composite.columnOrder)&&void 0!==s?s:k),U=w,x=()=>{var t,n;const a=null!==(t=e.settings.composite.hiddenColumns)&&void 0!==t?t:{};y!==a&&C(a);const s=null!==(n=e.settings.composite.columnOrder)&&void 0!==n?n:k;j!==s&&I(s)};return m.useEffect((()=>(e.settings.changed.connect(x),()=>{e.settings.changed.disconnect(x)}))),m.createElement("div",{className:"jp-NewLauncher-table"},e.showSearchBox?m.createElement("div",{className:"jp-Launcher-searchBox"},m.createElement(c.FilterBox,{placeholder:o.__("Filter kernels"),updateFilter:(e,t)=>{l(null!=t?t:"")},initialQuery:"",useFuzzyFilter:!1})):null,m.createElement("div",{className:"jp-NewLauncher-table-scroller",onContextMenu:t=>{var n;t.preventDefault();const a=new c.MenuSvg({commands:e.commands}),s=new c.MenuSvg({commands:e.commands});for(const e of _)s.addItem({command:E.toggleColumn,args:{id:e.id,label:e.label}});s.title.label=o.__("Visible Columns"),a.addItem({type:"submenu",submenu:s});const r=null===(n=t.target.closest("th[data-id]"))||void 0===n?void 0:n.dataset.id;r&&(a.addItem({command:E.moveColumn,args:{direction:"left",order:j,id:r}}),a.addItem({command:E.moveColumn,args:{direction:"right",order:j,id:r}})),a.open(t.clientX,t.clientY)}},m.createElement(U,{rows:e.items.filter((e=>-1!==e.label.toLowerCase().indexOf(r.toLowerCase()))).map((e=>({data:e,key:e.command+JSON.stringify(e.args)}))),blankIndicator:()=>m.createElement("div",null,o.__("No entries")),sortKey:"kernel",onRowClick:e=>{const t=e.target,n=t.closest("tr");if(!n)return;const a=t.closest("td"),s=null==a?void 0:a.querySelector(`.${D}`);if(s)return s.click();n.querySelector(`.${L}`).click()},columns:_.filter((e=>"hidden"!==y[e.id])).map((e=>{var t;return{...e,rank:null!==(t=j.indexOf(e.id))&&void 0!==t?t:10}})).sort(((e,t)=>e.rank-t.rank))})))}function U(e){const[t,n]=m.useState(e.open);return m.createElement("details",{onToggle:t=>{n(t.currentTarget.open),e.onToggled&&e.onToggled(t.currentTarget.open)},className:(0,c.classes)(e.className,"jp-CollapsibleSection"),open:t},m.createElement("summary",null,m.createElement("div",{className:"jp-CollapsibleSection-CollapserIconWrapper","aria-hidden":"true"},m.createElement(c.caretRightIcon.react,{className:"jp-CollapsibleSection-CollapserIcon"})),m.createElement(e.icon.react,{tag:"span",className:"jp-CollapsibleSection-CategoryIcon"}),m.createElement("h3",{className:"jp-CollapsibleSection-Title"},e.title)),m.createElement("div",{className:"jp-Launcher-CardGroup jp-Launcher-cardContainer"},e.children))}function x(e){var t;const{item:n}=e;return m.createElement("div",{onClick:()=>n.execute(),className:"jp-Launcher-TypeCard jp-LauncherCard",title:null!==(t=n.caption)&&void 0!==t?t:n.label,tabIndex:0},m.createElement("div",{className:"jp-LauncherCard-icon"},m.createElement(c.LabIcon.resolveReact,{icon:n.icon,iconClass:(0,c.classes)(n.iconClass,"jp-Icon-cover")})),m.createElement("div",{className:"jp-LauncherCard-label"},m.createElement("p",null,n.label)))}function B(e){var t;const{trans:n,cwd:a,typeItems:s,otherItems:o,favouritesChanged:r}=e,[l,i]=m.useState(""),[,d]=m.useReducer((e=>e+1),0),[u,g]=m.useState(e.settings.composite.starredSection),[v,f]=m.useState(e.settings.composite.searchAllSections),b=()=>{const t=e.settings.composite.starredSection;u!==t&&g(t);const n=e.settings.composite.searchAllSections;v!==n&&f(n)};if(m.useEffect((()=>(e.settings.changed.connect(b),()=>{e.settings.changed.disconnect(b)}))),r){const e=()=>{u&&d()};m.useEffect((()=>(r.connect(e),()=>{r.disconnect(e)})))}const _=new Set;for(const n of e.notebookItems){const e=null===(t=n.metadata)||void 0===t?void 0:t.kernel;if(e)for(const t of Object.keys(e))_.add(t)}const w=[...e.notebookItems,...e.consoleItems].filter((e=>e.starred)),y=e.settings.composite.collapsedSections;return m.createElement("div",{className:"jp-LauncherBody"},m.createElement("div",{className:"jp-NewLauncher-TopBar"},m.createElement("div",{className:"jp-Launcher-cwd"},m.createElement("h3",null,n.__("Current folder:")," ",m.createElement("code",null,a||"/"))),m.createElement("div",{className:"jp-NewLauncher-OtherItems"},o.map((e=>m.createElement(x,{item:e,trans:n}))))),v?m.createElement("div",{className:"jp-Launcher-searchBox"},m.createElement(c.FilterBox,{placeholder:n.__("Filter"),updateFilter:(e,t)=>{i(null!=t?t:"")},initialQuery:"",useFuzzyFilter:!1})):null,m.createElement(U,{className:"jp-Launcher-openByType",title:n.__("Create Empty"),icon:p,open:"collapsed"!==y["create-empty"]},s.filter((e=>!l||-1!==e.label.toLowerCase().indexOf(l.toLowerCase()))).map((e=>m.createElement(x,{item:e,trans:n})))),u?m.createElement(U,{className:"jp-Launcher-openByKernel",title:n.__("Starred"),icon:h,open:"collapsed"!==y.starred},w.length>0?m.createElement(I,{items:w,commands:e.commands,showSearchBox:!v,showWidgetType:!0,query:l,settings:e.settings,trans:n,onClick:e=>e.execute()}):"No starred items"):null,m.createElement(U,{className:"jp-Launcher-openByKernel jp-Launcher-launchNotebook",title:n.__("Launch New Notebook"),icon:c.notebookIcon,open:"collapsed"!==y["launch-notebook"]},m.createElement(I,{items:e.notebookItems,commands:e.commands,showSearchBox:!v,query:l,settings:e.settings,trans:n,onClick:e=>e.execute()})),m.createElement(U,{className:"jp-Launcher-openByKernel jp-Launcher-launchConsole",title:n.__("Launch New Console"),icon:c.consoleIcon,open:"collapsed"!==y["launch-console"]},m.createElement(I,{items:e.consoleItems,commands:e.commands,showSearchBox:!v,query:l,settings:e.settings,trans:n,onClick:e=>e.execute()})))}const K="server-proxy:open";class T extends r.Launcher{constructor(e){super(e),this.renderCommand=e=>new f({item:e,cwd:this.cwd,commands:this.commands,lastUsedDatabase:this._lastUsedDatabase,favoritesDatabase:this._favoritesDatabase}),this.renderKernelCommand=e=>this.renderCommand(e),this.commands=e.commands,this.trans=this.translator.load("jupyterlab-new-launcher"),this._lastUsedDatabase=e.lastUsedDatabase,this._favoritesDatabase=e.favoritesDatabase,this._settings=e.settings}render(){if(!this.model)return null;const e=this.trans,t=[...this.model.items()],n=e.__("Notebook"),a=e.__("Console"),s=[n,a],o=this._settings.composite.utilityCommands,r=t.filter((e=>o.includes(e.command))).map(this.renderCommand),l=t.filter((e=>(!e.category||!s.includes(e.category))&&!o.includes(e.command)||e.command===K)),i={"terminal:create-new":3,"fileeditor:create-new":6,"fileeditor:create-new-markdown-file":5};for(const e of l)e.command in i&&(e.rank=i[e.command]);const c=[{command:"notebook:create-new",rank:1},{command:"console:create",rank:4},...l].sort(((e,t)=>{var n,a;return(null!==(n=null==e?void 0:e.rank)&&void 0!==n?n:0)-(null!==(a=null==t?void 0:t.rank)&&void 0!==a?a:0)})),d=t.filter((e=>e.category&&e.category===n&&e.command!==K)).map(this.renderKernelCommand),u=t.filter((e=>e.category&&e.category===a&&e.command!==K)).map(this.renderKernelCommand),h=c.map(this.renderCommand);return m.createElement(B,{trans:this.trans,cwd:this.cwd,commands:this.commands,typeItems:h,notebookItems:d,consoleItems:u,otherItems:r,settings:this._settings,favouritesChanged:this._favoritesDatabase.changed})}}class A extends s.SessionContextDialogs{constructor(e){var t;super(e),this.options=e;const n=null!==(t=e.translator)&&void 0!==t?t:i.nullTranslator;this.trans=n.load("jupyterlab")}async selectKernel(e){const t=this.trans;if(e.isDisposed)return Promise.resolve();let n=t.__("Cancel");e.hasNoKernel&&(n=e.kernelDisplayName);const a=[s.Dialog.cancelButton({label:n}),s.Dialog.okButton({label:t.__("Select"),ariaLabel:t.__("Select Kernel"),className:"jp-KernelSelector-SelectButton"})],o=e.kernelPreference.autoStartDefault,r="boolean"==typeof o,l=await this.options.settingRegistry.load(k),i=new s.Dialog({title:t.__("Select Kernel"),body:new R({data:{specs:e.specsManager.specs,sessions:e.sessionManager.running(),preference:e.kernelPreference},name:e.name,commands:this.options.commands,favoritesDatabase:this.options.database.favorites,lastUsedDatabase:this.options.database.lastUsed,settings:l,trans:t,acceptDialog:()=>{i.resolve(1)}}),buttons:a,checkbox:r?{label:t.__("Always start the preferred kernel"),caption:t.__("Remember my choice and always start the preferred kernel"),checked:o}:null});i.node.classList.add("jp-KernelSelector-Dialog");const c=await i.launch();if(e.isDisposed||!c.button.accept)return;r&&null!==c.isChecked&&(e.kernelPreference={...e.kernelPreference,autoStartDefault:c.isChecked});const d=c.value;if(null===d&&!e.hasNoKernel)return e.shutdown();d&&await e.changeKernel(d)}}const M={id:"jupyterlab-new-launcher:dialogs",description:"Session dialogs for redesigned JupyterLab launcher",provides:s.ISessionContextDialogs,autoStart:!0,requires:[i.ITranslator,j,l.ISettingRegistry],activate:(e,t,n,a)=>new A({translator:t,database:n,commands:e.commands,settingRegistry:a})};class R extends s.ReactWidget{constructor(e){super(),this.options=e,this.renderKernelCommand=e=>new f({item:e,cwd:"",commands:this.commands,lastUsedDatabase:this._lastUsedDatabase,favoritesDatabase:this._favoritesDatabase}),this._selection=null,this.commands=e.commands,this._lastUsedDatabase=e.lastUsedDatabase,this._favoritesDatabase=e.favoritesDatabase,this._settings=e.settings,this._name=e.name,this.trans=e.trans}onBeforeAttach(e){super.onBeforeAttach(e),this.node.style.minWidth="",this.node.style.minHeight=""}onAfterAttach(e){super.onAfterAttach(e),requestAnimationFrame((()=>{const e=this.node.getBoundingClientRect();this.node.style.minWidth=e.width+"px",this.node.style.minHeight=e.height+"px"}))}render(){var e;const t=[],n=this.options.data.specs.kernelspecs;for(const e of Object.values(n)){if(!e)continue;const n=e.resources["logo-svg"]||e.resources["logo-64x64"];t.push({command:"notebook:create-new",args:{isLauncher:!0,kernelName:e.name},kernelIconUrl:n,metadata:{kernel:C.JSONExt.deepCopy(e.metadata||{})}})}const a=[];for(const t of this.options.data.sessions){const s=t.kernel;if(!s)continue;const o=n[s.name],r=o.resources["logo-svg"]||o.resources["logo-64x64"];a.push({command:"notebook:create-new",args:{isLauncher:!0,kernelName:o.name},kernelIconUrl:r,metadata:{kernel:{...C.JSONExt.deepCopy(o.metadata||{}),state:null!==(e=s.execution_state)&&void 0!==e?e:"running","used by":t.name},model:s}})}const s=t.map(this.renderKernelCommand),o=a.map(this.renderKernelCommand);return m.createElement(m.Fragment,null,m.createElement("h3",{className:"jp-KernelSelector-Section"},this.trans.__('Start a new kernel for "%1"',this._name)),m.createElement(I,{trans:this.trans,commands:this.commands,items:s,settings:this._settings,query:"",showSearchBox:!0,onClick:e=>{this._selection=e,this.options.acceptDialog()}}),o.length>0?m.createElement(m.Fragment,null,m.createElement("h3",{className:"jp-KernelSelector-Section"},this.trans.__("Connect to a running kernel")),m.createElement(I,{trans:this.trans,commands:this.commands,items:o,settings:this._settings,query:"",showSearchBox:!1,onClick:e=>{this._selection=e,this.options.acceptDialog()},hideColumns:["last-used","star"]})):null)}getValue(){var e;return this._selection?(null===(e=this._selection.metadata)||void 0===e?void 0:e.model)?this._selection.metadata.model:{name:this._selection.args.kernelName}:null}}var O=n(101);class z{constructor(e){this._updateDB=async()=>{const e=await this._fetch();this._db=e},this._db=null,this._stateDB=e.stateDB;const t=new C.PromiseDelegate;this.ready=t.promise,this._updateDB().then((()=>t.resolve())),window.setInterval(this._updateDB,e.fetchInterval)}_get(e){return this._db?this._db[this._itemKey(e)]:(console.error("Database is not ready!"),null)}async _set(e,t){const n=await this._fetch();this._db=n,n[this._itemKey(e)]=t,await this._stateDB.save(this._stateDBKey,n)}async _fetch(){let e=await this._stateDB.fetch(this._stateDBKey);return void 0===e&&(e=await this._stateDB.fetch(this._stateDBKey)),void 0===e?{}:e}}class H extends z{_itemKey(e){return e.command+"_"+JSON.stringify(e.args)}}class F extends H{constructor(){super(...arguments),this._stateDBKey="new-launcher:last-used"}get(e){const t=super._get(e);return t?new Date(t):null}async recordAsUsedNow(e){this._set(e,(new Date).toUTCString())}}class q extends H{constructor(){super(...arguments),this._stateDBKey="new-launcher:favorites",this._changed=new v.Signal(this)}get(e){var t;return null!==(t=super._get(e))&&void 0!==t?t:null}async set(e,t){this._set(e,t),this._changed.emit()}get changed(){return this._changed}}const P={id:"jupyterlab-new-launcher:database",description:"A redesigned JupyterLab launcher databases",provides:j,autoStart:!0,requires:[O.IStateDB],activate:(e,t)=>{const n={stateDB:t,fetchInterval:1e4};return{lastUsed:new F(n),favorites:new q(n)}}},V=[{id:k,description:"A redesigned JupyterLab launcher",provides:r.ILauncher,autoStart:!0,requires:[i.ITranslator,l.ISettingRegistry,j],optional:[a.ILabShell,s.ICommandPalette,o.IDefaultFileBrowser],activate:function(e,t,n,a,o,l,i){const{commands:m,shell:u}=e,h=t.load("jupyterlab-new-launcher"),p=new r.LauncherModel;if(-1!==navigator.userAgent.indexOf("AppleWebKit")&&-1===navigator.userAgent.indexOf("Chrome")){const e=function(e){const t=document.createElement("style");return t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(".jp-starIconButton {\n  /* do not rotate on webkit as the result is off when zoomed in see https://bugs.webkit.org/show_bug.cgi?id=194903 */\n  --jp-transition-transform: rotate(0deg);\n}\n\n.jp-starIcon .jp-star-filled,\n.jp-starIcon .jp-star-border {\n  /* disable animation on webkit */\n  transition-property: none;\n}\n")),t}();document.body.appendChild(e)}return n.load(k).then((t=>{!function(e,t,n){e.commands.addCommand(E.toggleColumn,{label:e=>{if(e.label)return e.label;if(e.id){const t=e.id;return t[0].toLocaleUpperCase()+t.substring(1)}return t.__("Toggle given column")},execute:async e=>{var t;const a=e.id;if(!a)return console.error("Column ID missing");const s=null!==(t=n.user.hiddenColumns)&&void 0!==t?t:{};"visible"!==s[a]&&s[a]?s[a]="visible":s[a]="hidden",await n.set("hiddenColumns",s)},isToggleable:!0,isToggled:e=>{var t;const a=e.id;return a?"hidden"!==(null!==(t=n.user.hiddenColumns)&&void 0!==t?t:{})[a]:(console.error("Column ID missing for checking if toggled"),!1)}}),e.commands.addCommand(E.moveColumn,{label:e=>"left"===e.direction?t.__("Move Column Left"):"right"===e.direction?t.__("Move Column Right"):t.__("Move column left or right"),execute:async e=>{const t=e.order,a=e.id,s=t.indexOf(a),o=s+("left"===e.direction?-1:1);if(o<0||o>=t.length)return void console.log("Cannot move the column any further");const r=t[o];t[o]=a,t[s]=r,await n.set("columnOrder",t)}})}(e,h,t)})),m.addCommand(E.create,{label:h.__("New Launcher"),icon:e=>e.toolbar?c.addIcon:void 0,execute:async e=>{var r,l;const g=null!==(l=null!==(r=e.cwd)&&void 0!==r?r:null==i?void 0:i.model.path)&&void 0!==l?l:"",v="launcher-"+W.id++,f=await n.load(k);await Promise.all([a.lastUsed.ready,a.favorites.ready]);const b=new T({model:p,cwd:g,callback:e=>{(0,d.find)(u.widgets("main"),(t=>t===e))&&(u.add(e,"main",{ref:v}),b.dispose())},commands:m,translator:t,lastUsedDatabase:a.lastUsed,favoritesDatabase:a.favorites,settings:f});b.model=p,b.title.icon=c.launcherIcon,b.title.label=h.__("Launcher");const _=new s.MainAreaWidget({content:b});if(_.title.closable=!!Array.from(u.widgets("main")).length,_.id=v,u.add(_,"main",{activate:e.activate,ref:e.ref}),o&&o.layoutModified.connect((()=>{_.title.closable=Array.from(o.widgets("main")).length>1}),_),i){const e=e=>{b.cwd=e.path};i.model.pathChanged.connect(e),b.disposed.connect((()=>{i.model.pathChanged.disconnect(e)}))}return _}}),o&&Promise.all([e.restored,null==i?void 0:i.model.restored]).then((()=>{o.layoutModified.connect((()=>{o.isEmpty("main")&&m.execute(E.create)}))})),l&&l.addItem({command:E.create,category:h.__("Launcher")}),o&&(o.addButtonEnabled=!0,o.addRequested.connect(((e,t)=>{var n;const a=(null===(n=t.currentTitle)||void 0===n?void 0:n.owner.id)||t.titles[t.titles.length-1].owner.id;return m.execute(E.create,{ref:a})}))),p}},M,P];var W;!function(e){e.id=0}(W||(W={}))}}]);