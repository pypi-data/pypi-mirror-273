{"version":3,"file":"lib_index_js.bb1914d804cc68cedb6d.js","mappings":"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","sources":["webpack://jupyter-fairly/./src/dataset.ts","webpack://jupyter-fairly/./src/handler.ts","webpack://jupyter-fairly/./src/index.ts","webpack://jupyter-fairly/./src/menu.ts","webpack://jupyter-fairly/./src/metadata.ts","webpack://jupyter-fairly/./src/upload.ts","webpack://jupyter-fairly/./src/widgets/CloneForm.ts"],"sourcesContent":["import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\n\nimport { \n  addIcon,\n  downloadIcon\n } from '@jupyterlab/ui-components';\n\nimport { \n  Dialog, \n  showDialog, \n  InputDialog, \n  showErrorMessage,\n  Notification\n} from '@jupyterlab/apputils';\n\nimport { PromiseDelegate, ReadonlyJSONValue } from '@lumino/coreutils';\n\nimport { IFileBrowserFactory } from '@jupyterlab/filebrowser';\nimport { requestAPI } from './handler';\nimport { FairlyCloneForm } from './widgets/CloneForm';\n// import { logger } from './logger';\n// import { Level } from './tokens';\n\nfunction initDataset(path: string, template?: any) {\n  /**\n   * Initializes a Fairly dataset\n   * @param path - path to dataset root directory. Default to current path\n   * @param template - alias of template for manifest.yalm\n   */\n\n  // name of the template for manifest.yalm\n  let templateMeta = '';\n  /* ./ is necessary becaucause defaultBrowser.Model.path\n  * returns an empty string when fileBlowser is on the\n  * jupyterlab root directory     \n  */\n  let rootPath = './'\n  if(template === '4TU.Research' || template === 'Figshare') {\n    templateMeta = 'figshare';\n  }\n  else if (template === 'Zenodo'){\n    templateMeta = 'zenodo'\n  }\n  else if (template == null || template === 'Default'){\n    templateMeta = 'default'\n  }\n\n  console.log(rootPath.concat(path))\n  requestAPI<any>('newdataset', {\n    method: 'POST', \n    body: JSON.stringify({\n      path: rootPath.concat(path),  // TODO: this might not work in Windows\n      template: templateMeta\n    })\n  }) \n  .then(data => {\n    console.log(data);\n  })\n  .catch(reason => {\n    console.error(\n      `${reason}`\n    );\n    // show error when manifest.yalm already exist in rootPath\n    showErrorMessage(\"Error: Has the dataset been initilized already?\", reason)\n  });\n}\n\nfunction cloneDataset(source: string, destination: string, extract: boolean = false, client?: any) {\n  /**\n   * clones a remote dataset to a directory\n   * @param source - DOI or URL to the remote dataset\n   * @param destination - realtive path to a directory to store the dataset\n   * @param client - fairly client\n   */\n\n  /* ./ is necessary becaucause defaultBrowser.Model.path\n  * returns an empty string when fileBlowser is on the\n  * jupyterlab root directory     \n  */\n  let rootPath = './';\n  let _client = '4tu';\n\n  let payload = JSON.stringify({\n    source: source,\n    destination: rootPath.concat(destination),  // TODO: this might not work in Windows\n    extract: extract,\n    client: _client\n  });\n\n  console.log(rootPath.concat(destination));\n  \n  // notification\n  const delegate = new PromiseDelegate<ReadonlyJSONValue>();\n  const complete = \"complete\";\n  const failed = \"failed\"\n\n  requestAPI<any>('clone', {\n    method: 'POST', \n    body: payload\n  }) \n  .then(data => {\n    console.log(data);\n    delegate.resolve({ complete });\n  })\n  .catch(reason => {\n    delegate.reject({failed})\n    // show error when destination directory is not empty\n    showErrorMessage(\"Error when cloning dataset\", reason)\n  });\n\n  Notification.promise(delegate.promise, {\n    pending: { message: 'Cloning dataset...', options: { autoClose: false } },\n    success: {\n      message: (result: any) =>\n      `Clonning ${result.complete}.`,\n      options: {autoClose: 3000}\n    },\n    error: {message: () => `Cloning failed.`}\n  });\n  \n}\n\nexport const cloneDatasetCommandPlugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly/clone',\n  requires: [IFileBrowserFactory],\n  autoStart: true,\n  activate: (\n    app: JupyterFrontEnd,\n    fileBrowserFactory: IFileBrowserFactory\n  ) => {\n \n    const fileBrowser = fileBrowserFactory.tracker.currentWidget;\n    const fileBrowserModel = fileBrowser.model;\n\n    const cloneDatasetCommand = \"cloneDataset\";\n  \n    app.commands.addCommand(cloneDatasetCommand, {\n      label: 'Clone Dataset',\n      isEnabled: () => true,\n      isVisible: () => true,\n      icon: downloadIcon,\n      execute: async () => {\n        const result = await showDialog({\n          title: 'Clone Dataset',\n          body: new FairlyCloneForm(),\n          buttons: [\n            Dialog.cancelButton({ label: 'Cancel'}),\n            Dialog.okButton({ label: 'Clone'})\n          ],\n          checkbox: {\n            label: 'Extract compressed files',\n            caption: 'Uncompress zip and tar.gz files',\n            checked: false\n          }\n        });\n\n        if (result.button.accept && result.value) {\n\n          try {      \n            cloneDataset(result.value, fileBrowserModel.path, result.isChecked);\n            console.log('accepted');\n            await fileBrowserModel.refresh();\n          } catch (error) {\n            console.error(\n              'Encontered an error when cloning the dataset: ', \n              error\n            )\n          };\n\n        } else {\n          console.log('rejected')\n        }\n      } \n    });\n\n    app.contextMenu.addItem({\n      command: cloneDatasetCommand,\n      // matches anywhere in the filebrowser\n      selector: '.jp-DirListing-content',\n      rank: 103\n    });\n\n  }\n};\n\nexport const createDatasetCommandPlugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly/create-dataset',\n  requires: [IFileBrowserFactory],\n  autoStart: true,\n  activate: (\n    app: JupyterFrontEnd,\n    fileBrowserFactory: IFileBrowserFactory\n  ) => {\n   \n \n    const fileBrowser = fileBrowserFactory.tracker.currentWidget;\n    const fileBrowserModel = fileBrowser.model;\n\n  \n    const createDatasetCommand = \"createDatasetCommand\"\n\n    app.commands.addCommand(createDatasetCommand, {\n      label: 'Create Fairly Dataset',\n      isEnabled: () => true,\n      isVisible: () => true,\n      icon: addIcon,\n      execute: async () => {\n\n        // return relative path w.r.t. jupyter root path.\n        // root-path = empty string.\n        console.log( `the path is: ${fileBrowserModel.path}` );\n\n        let metadataTemplate = await InputDialog.getItem({\n          title: 'Select template for dataset\\'s metadata',\n          items: ['', 'Default', '4TU.Research',  'Zenodo', 'Figshare'],\n          okLabel: 'Create',\n        });\n        \n        // initialize dataset when accept button is clicked and \n        // vaule for teamplate is not null\n        if (metadataTemplate.button.accept && metadataTemplate.value) {\n          console.log( `the path is: ${fileBrowserModel.path}` );\n          initDataset(fileBrowserModel.path , metadataTemplate.value);\n          await fileBrowserModel.refresh();\n        } else{\n          console.log('rejected')\n          return\n        }\n\n      }\n    });\n\n    app.contextMenu.addItem({\n      command: createDatasetCommand,\n      // matches anywhere in the filebrowser\n      selector: '.jp-DirListing-content',\n      rank: 100\n    });\n  }\n};\n\n","import { URLExt } from '@jupyterlab/coreutils';\n\nimport { ServerConnection } from '@jupyterlab/services';\n\n/**\n * Call the API extension\n *\n * @param endPoint API REST end point for the extension\n * @param init Initial values for the request\n * @returns The response body interpreted as JSON\n */\nexport async function requestAPI<T>(\n  endPoint = '',\n  init: RequestInit = {}\n): Promise<T> {\n  // Make request to Jupyter API\n  const settings = ServerConnection.makeSettings();\n  const requestUrl = URLExt.join(\n    settings.baseUrl,\n    'jupyter-fairly', // API Namespace\n    endPoint\n  );\n\n  let response: Response;\n  try {\n    response = await ServerConnection.makeRequest(requestUrl, init, settings);\n  } catch (error: any) {\n    throw new ServerConnection.NetworkError(error);\n  }\n\n  let data: any = await response.text();\n\n  if (data.length > 0) {\n    try {\n      data = JSON.parse(data);\n    } catch (error) {\n      console.log('Not a JSON response body.', response);\n    }\n  }\n\n  if (!response.ok) {\n    throw new ServerConnection.ResponseError(response, data.message || data);\n  }\n\n  return data;\n}\n","import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\n\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\n\nimport { \n  createDatasetCommandPlugin,\n  cloneDatasetCommandPlugin, \n} from './dataset';\nimport {editMetadataPlugin} from './metadata'\nimport { uploadDatasetPlugin} from './upload';\nimport { FairlyMenuPlugin } from './menu';\n\n/**\n *  Activate jupyter-fairly extension.\n */\nconst plugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly:plugin',\n  autoStart: true,\n  requires : [],\n  optional: [ISettingRegistry],\n  activate: (app: JupyterFrontEnd) => {\n    console.log('JupyterLab extension jupyter-fairly is activated!');\n      \n    }\n};\n\n\nexport default [\n  plugin, \n  createDatasetCommandPlugin, \n  editMetadataPlugin, \n  uploadDatasetPlugin,\n  cloneDatasetCommandPlugin,\n  FairlyMenuPlugin,\n];\n\n","import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin,\n} from '@jupyterlab/application';\n\nimport {\n  InputDialog,\n  Notification\n} from '@jupyterlab/apputils';\n\nimport { \n  IFileBrowserFactory \n} from '@jupyterlab/filebrowser';\n\n// Icons\nimport {\n  settingsIcon,\n} from '@jupyterlab/ui-components';\nimport { requestAPI } from './handler';\nimport { showErrorMessage } from '@jupyterlab/apputils';\n\n\nfunction registerToken(repository: string,  newToken: string) {\n  /**\n   * register token to fairly configuration file\n   * @param repository- name of data repository\n   * @param newToken - access token for data repository\n   */\n\n  var clientId;\n  \n  if(repository === '4TU.ResearchData') {\n    clientId = '4tu';\n  }\n  else if (repository === 'Zenodo'){\n    clientId = 'zenodo'\n  }\n  else if (repository === 'Figshare'){\n    clientId = 'figshare'\n  };\n\n  let payload = JSON.stringify({\n    client: clientId,  \n    token: newToken\n  });\n\n  requestAPI<any>('repo-token', {\n    method: 'POST', \n    body: payload\n  }) \n  .then(data => {\n    console.log(data);\n    // show notification when requestAPI succeeds\n    Notification.success('Access Token registered successfully.', \n      {autoClose: 3000});\n  })\n  .catch(reason => {\n    // show error when requestAPI fails\n    // TODO: show error message in notification, and add reason as callback()\n    showErrorMessage(\"Error when registering access token\", reason)\n  });\n};\n\n\n/**\n* Initialization data for the main menu example.\n*/\nexport const FairlyMenuPlugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly/mainmenu',\n  requires: [IFileBrowserFactory],\nautoStart: true,\nactivate: (\n  app: JupyterFrontEnd,\n) => {\n  console.log(\"registerTokenPlugin activated!!\");\n\n  const registerTokenCommand = 'registerAccessToken'\n  app.commands.addCommand(registerTokenCommand, {\n    label: 'Add Repository Token',\n    isEnabled: () => true,\n    isVisible: () => true, \n    icon: settingsIcon,\n    execute: async() => {\n\n      // Asks for the data repository\n      let targetRepository = await InputDialog.getItem({\n        title: 'Register Access Token. Select Data Repository',\n        items: ['4TU.ResearchData', 'Zenodo', 'Figshare'],\n        okLabel: 'Continue',\n      });\n      \n      if (targetRepository.button.accept && targetRepository.value) {\n        \n        // Asks for the access token\n        let accessToken = await InputDialog.getText({\n          title: 'Enter Access Token for: '.concat(targetRepository.value),\n          placeholder: 'Access Token',\n          okLabel: 'Add Token',\n        });\n\n        if (accessToken.button.accept){\n          console.log ('registering token');\n          registerToken(targetRepository.value, accessToken.value)\n        }else {\n          console.log('operation was canceled by the user');\n          return\n        };\n\n      } else{\n        console.log('canceled')\n        return\n      };\n    }\n  });\n\n  const openURLCommand = 'fairly:openURL'\n  app.commands.addCommand(openURLCommand, {\n    label: 'Fairly Documentation',\n    caption: 'Fairly Documentation',\n    execute: (args: any) => {\n      window.open(`${args['url']}`, '_blank');      \n    }\n  });  \n}\n}\n","import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\n\nimport {\n  editIcon,\n} from '@jupyterlab/ui-components';\n\nimport { IFileBrowserFactory } from '@jupyterlab/filebrowser';\nimport { showErrorMessage } from '@jupyterlab/apputils';\n\nexport const editMetadataPlugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly/metadata',\n  requires: [IFileBrowserFactory],\n  autoStart: true,\n  activate: (\n    app: JupyterFrontEnd,\n    fileBrowserFactory: IFileBrowserFactory\n  ) => {\n\n    const fileBrowser = fileBrowserFactory.tracker.currentWidget;\n    const fileBrowserModel = fileBrowser.model;\n\n    // Open the manifest.yalm file in the file editor\n    const openManifestCommand = \"openManifestCommand\"\n    app.commands.addCommand(openManifestCommand, {\n      label: 'Edit Dataset Metadata',\n      isEnabled: () => true,\n      isVisible: () => true, // TODO: set depending if the dataset is initiated or not\n      icon: editIcon,\n      execute: () => {\n\n        \n        let currentPath = './'.concat(fileBrowserModel.path);\n        const pathManifest = currentPath.concat('/manifest.yaml');\n        /* We assume that the current directory contains the\n        manifest.yalm, if not we show an error message\n         */\n        try {\n          fileBrowserModel.manager.open(pathManifest)\n        } catch (error: any) {\n          // TODO: customize error type\n          showErrorMessage(\"Error Opening manifest.yalm\", error);\n        };\n        \n      }\n    });\n\n    app.contextMenu.addItem({\n      command: openManifestCommand,\n      // matches anywhere in the filebrowser\n      selector: '.jp-DirListing-content',\n      rank: 101\n    });\n  }\n};\n","import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\n\nimport {\n  InputDialog,\n  Notification,\n  showDialog,\n  Dialog\n} from '@jupyterlab/apputils';\n\nimport { \n  IFileBrowserFactory \n} from '@jupyterlab/filebrowser';\n\nimport { PromiseDelegate, ReadonlyJSONValue } from '@lumino/coreutils';\n\n// Icons\nimport {\n  fileUploadIcon,\n  redoIcon\n} from '@jupyterlab/ui-components';\nimport { requestAPI } from './handler';\nimport { showErrorMessage } from '@jupyterlab/apputils';\n\n\n\n function uploadDataset(directory: string,  repository: string) {\n  /**\n   * upload local dataset to data reposotory\n   * @param directory - realtive path to directory of local dataset\n   * @param repository - name of data repository\n   */\n\n  /* ./ is necessary becaucause defaultBrowser.Model.path\n  * returns an empty string when fileBlowser is on the\n  * jupyterlab root directory     \n  */\n  let rootPath = './';\n\n  var client;\n  \n  if(repository === '4TU.ResearchData') {\n    client = '4tu';\n  }\n  else if (repository === 'Zenodo'){\n    client = 'zenodo'\n  }\n  else if (repository === 'Figshare'){\n    client = 'figshare'\n  };\n\n  let payload = JSON.stringify({\n    directory: rootPath.concat(directory),  // TODO: this might not work in Windows\n    client: client\n  });\n\n  // notification\n  const delegate = new PromiseDelegate<ReadonlyJSONValue>();\n  const complete = \"complete\";\n  const failed = \"failed\"\n  \n  requestAPI<any>('upload', {\n    method: 'POST', \n    body: payload\n  }) \n  .then(data => {\n    console.log(data);\n    delegate.resolve({ complete });\n  })\n  .catch(reason => {\n    delegate.reject({ failed });\n    // show error when \n    showErrorMessage(\"Error when uploading dataset\", reason)\n  });\n\n  Notification.promise(delegate.promise, {\n    pending: { message: 'Uploading dataset...', options: { autoClose: false } },\n    success: {\n      message: (result: any) =>\n      `Dataset upload ${result.complete}.`,\n      options: {autoClose: 3000}\n    },\n    error: {message: () => `Upload failed.`}\n  });\n\n};\n\n\nfunction pushDataset(localDataset: string) {\n  /**\n   * upload local dataset to data reposotory\n   * @param localDataset - realtive path to directory of local dataset with remote metadata\n   */\n\n  /* ./ is necessary becaucause defaultBrowser.Model.path\n  * returns an empty string when fileBlowser is on the\n  * jupyterlab root directory     \n  */\n  let rootPath = './';\n\n  let payload = JSON.stringify({\n    localdataset: rootPath.concat(localDataset)\n  });\n\n  // notification\n  const delegate = new PromiseDelegate<ReadonlyJSONValue>();\n  const complete = \"complete\";\n  const failed = \"failed\"\n  \n  requestAPI<any>('push', {\n    method: 'PATCH', \n    body: payload\n  }) \n  .then(data => {\n    console.log(data);\n    delegate.resolve({ complete });\n  })\n  .catch(reason => {\n    delegate.reject({ failed });\n    // show error when \n    showErrorMessage(\"Error when updating remote dataset\", reason)\n  });\n\n  Notification.promise(delegate.promise, {\n    pending: { message: 'Pushing dataset to repository ...', options: { autoClose: false } },\n    success: {\n      message: (result: any) =>\n      `Remote dataset update ${result.complete}.`,\n      options: {autoClose: 3000}\n    },\n    error: {message: () => `Pushing has failed.`}\n  });\n\n};\n\n\nexport const uploadDatasetPlugin: JupyterFrontEndPlugin<void> = {\n  id: '@jupyter-fairly/upload',\n  requires: [IFileBrowserFactory],\n  autoStart: true,\n  activate: (\n    app: JupyterFrontEnd,\n    fileBrowserFactory: IFileBrowserFactory\n  ) => {\n    console.log(\"uploadDatasetPlugin activated!!\");\n    // const fileBrowser = fileBrowserFactory.defaultBrowser;\n    const fileBrowser = fileBrowserFactory.tracker.currentWidget;\n    const fileBrowserModel = fileBrowser.model;\n\n    \n    // ** Upload a new dataset to a data repository **\n    const uploadDatasetCommand = \"uploadDataset\"\n    app.commands.addCommand(uploadDatasetCommand, {\n      label: 'Upload Dataset',\n      isEnabled: () => true,\n      isVisible: () => true, // activate only when current directory contains a manifest.yalm\n      icon: fileUploadIcon,\n      execute: async() => {\n\n        // return relative path w.r.t. jupyterlab root path.\n        // root-path = empty string.\n\n        let targetRepository = await InputDialog.getItem({\n          title: 'Select Data Repository',\n          items: ['4TU.ResearchData',  'Zenodo', 'Figshare'],\n          okLabel: 'Continue',\n        });\n        \n        // initialize dataset when accept button is clicked and \n        // vaule for teamplate is not null\n        if (targetRepository.button.accept && targetRepository.value) {\n          \n          let confirmAction = await InputDialog.getBoolean({\n            title: 'Do you want to upload the dataset?',\n            label: `Yes, upload metadata and files to ${targetRepository.value}`\n          });\n\n          if (confirmAction.button.accept){\n            console.log ('uploading dataset');\n            uploadDataset(fileBrowserModel.path, targetRepository.value)\n          }else {\n            console.log('do not archive');\n            return\n          };\n\n        } else{\n          console.log('rejected')\n          return\n        }\n\n      }\n    });\n\n    // ** Push changes made to a local dataset to a data repository **\n    const pushCommand = \"pushDataset\"\n    app.commands.addCommand(pushCommand, {\n      label: 'Push',\n      isEnabled: () => true,\n      isVisible: () => true, // activate only when current directory contains a manifest.yalm\n      icon: redoIcon,\n      execute: async() => {\n\n        let confirmAction = await showDialog({\n            title: 'Push changes', // Can be text or a react element\n            body: 'This will update the data repository using changes made here.', \n            host: document.body, // Parent element for rendering the dialog\n            buttons: [Dialog.cancelButton(), Dialog.okButton({ label: 'Push' })],\n          })\n\n        if (confirmAction.button.accept){\n          await pushDataset(fileBrowserModel.path)\n        } else {\n          console.log('rejected');\n          return\n        };\n      }\n    });\n\n    app.contextMenu.addItem({\n      command: uploadDatasetCommand,\n      // matches anywhere in the filebrowser\n      selector: '.jp-DirListing-content',\n      rank: 104\n    }\n    );\n    app.contextMenu.addItem({\n      command: pushCommand,\n      // matches anywhere in the filebrowser\n      selector: '.jp-DirListing-content',\n      rank: 105\n    }\n    );\n  }\n};\n","import { Widget } from '@lumino/widgets';\n\n/**\n * The UI for the form fields shown within the Clone modal.\n */\nexport class FairlyCloneForm extends Widget {\n  /**\n   * Creates a form for cloning datasets\n   * \n   */\n   constructor() {\n    super({ node: FairlyCloneForm.createFormNode() });\n  }\n\n  /**\n   * Returns the input value as plain text\n   */\n  getValue(): string {\n    // TODO: this should be properly initialized, \n    // See: https://stackoverflow.com/questions/40349987/how-to-suppress-error-ts2533-object-is-possibly-null-or-undefined\n    return this.node.querySelector('input').value.trim(); // strickNullChecks = true, brakes this code\n  }\n\n  private static createFormNode(): HTMLElement {\n    const node = document.createElement('div');\n    const label = document.createElement('label');\n    const input = document.createElement('input');\n    const text = document.createElement('span');\n\n    node.className = 'jp-RedirectForm';\n    text.textContent = 'Enter URL or DOI: ';\n    input.placeholder = 'https://doi.org/xx.x/xx.vx';\n\n    label.appendChild(text);\n    label.appendChild(input);\n    node.appendChild(label);\n    return node;\n  }\n}\n"],"names":[],"sourceRoot":""}