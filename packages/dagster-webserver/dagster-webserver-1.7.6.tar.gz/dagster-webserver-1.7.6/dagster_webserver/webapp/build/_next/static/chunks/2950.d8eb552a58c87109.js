"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2950],{43250:function(e,t,n){n.d(t,{C:function(){return u}});var r=n(52322),s=n(92506),i=n(14934),o=n(38491),l=n(11452),a=n(2784),c=n(44231),d=n(46146);let u=()=>{let{allRepos:e,visibleRepos:t,toggleVisible:n}=(0,a.useContext)(d.C5),[u,h]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:u,style:{width:"auto"},onClose:()=>h(!1),children:[(0,r.jsx)(s.fK,{icon:"repo",label:"Filter code locations"}),(0,r.jsx)(c.e,{options:e,onBrowse:()=>h(!1),onToggle:n,selected:t}),(0,r.jsx)(s.cN,{children:(0,r.jsx)(i.x,{padding:{top:8},children:(0,r.jsx)(o.zx,{intent:"none",onClick:()=>h(!1),children:"Done"})})})]}),(0,r.jsx)(o.zx,{outlined:!0,icon:(0,r.jsx)(l.JO,{name:"folder"}),rightIcon:(0,r.jsx)(l.JO,{name:"expand_more"}),onClick:()=>h(!0),children:"".concat(t.length," of ").concat(e.length)})]})}},63065:function(e,t,n){n.d(t,{e:function(){return F}});var r=n(73235),s=n(52322),i=n(40794),o=n(89130),l=n(14934),a=n(79106),c=n(39013),d=n(37483),u=n(74159),h=n(45774),x=n(2784),p=n(78491),j=n(16336),m=n(44900),g=n(4378),f=n(43250),v=n(35002),w=n(43212),y=n(88510),b=n(22921),C=n(17008),k=n(98956),N=n(50646),O=n(63485),T=n(83738),L=n(22563);let E=e=>{let{repos:t}=e,n=(0,x.useRef)(null),r=(0,x.useMemo)(()=>t.map(e=>{let{repoAddress:t}=e;return(0,L.Uz)(t)}),[t]),{expandedKeys:i,onToggle:o,onToggleAll:l}=(0,N.N)(b.y,r),a=(0,x.useMemo)(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,jobs:r}=t;e.push({type:"header",repoAddress:n,jobCount:r.length});let s=(0,L.Uz)(n);i.includes(s)&&r.forEach(t=>{let{isJob:r,name:s}=t;e.push({type:"job",repoAddress:n,isJob:r,name:s})})}),e},[t,i]),c=(0,k.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),d=(0,y.MG)({count:a.length,getScrollElement:()=>n.current,estimateSize:e=>{let t=a[e];return(null==t?void 0:t.type)==="header"?C.lo:64},overscan:10}),u=d.getTotalSize(),h=d.getVirtualItems();return(0,s.jsx)("div",{style:{overflow:"hidden"},children:(0,s.jsxs)(C.W2,{ref:n,children:[(0,s.jsx)(O.I,{}),(0,s.jsx)(C.Nh,{$totalHeight:u,children:h.map(e=>{let{index:t,key:n,size:r,start:d}=e,u=a[t];return"header"===u.type?(0,s.jsx)(T.vG,{repoAddress:u.repoAddress,height:r,start:d,onToggle:o,onToggleAll:l,expanded:i.includes((0,L.Uz)(u.repoAddress)),showLocation:c.has(u.repoAddress.name),rightElement:(0,s.jsx)(v.u,{content:1===u.jobCount?"1 job":"".concat(u.jobCount," jobs"),placement:"top",children:(0,s.jsx)(w.V,{children:u.jobCount})})},n):(0,s.jsx)(O.b,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:r,start:d},n)})})]})})};var A=n(907),I=n(49455),S=n(34219),R=n(73658),_=n(46146),z=n(65822);function M(){let e=(0,r._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return M=function(){return e},e}let F=()=>{let{allRepos:e,visibleRepos:t,loading:n}=(0,x.useContext)(_.C5),[r,o]=(0,g.q)({queryKey:"search",defaults:{search:""}}),p=e.length,m=(0,i.a)($,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0});(0,S.Hu)(m,"OverviewJobsQuery");let{data:v,loading:w}=m,y=(0,j.C4)(m,j.dT),b=(0,x.useMemo)(()=>{let e=(0,I.S)(t);return P(v).filter(t=>{let{repoAddress:n}=t;return e.has((0,L.Uz)(n))})},[v,t]),C=r.trim().toLocaleLowerCase(),k=C.length>0,N=(0,x.useMemo)(()=>{let e=C.toLocaleLowerCase();return b.map(t=>{let{repoAddress:n,jobs:r}=t;return{repoAddress:n,jobs:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{jobs:t}=e;return t.length>0})},[b,C]),O=n&&!p||w&&!v;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},children:[(0,s.jsxs)(l.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[p>1?(0,s.jsx)(f.C,{}):null,(0,s.jsx)(u.oi,{icon:"search",value:r,rightElement:O?(0,s.jsx)(R.W,{tooltipContent:"Loading jobs…"}):void 0,onChange:e=>o(e.target.value),placeholder:"Filter by job name…",style:{width:"340px"}})]}),(0,s.jsx)(j.xi,{refreshState:y})]}),w&&!p?(0,s.jsx)(l.x,{padding:64,children:(0,s.jsx)(h.f,{label:"Loading jobs…"})}):(()=>{if(w&&!v)return(0,s.jsx)(l.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,s.jsx)(a.$,{purpose:"body-text"}),(0,s.jsx)("div",{style:{color:c.$()},children:"Loading jobs…"})]})});let n=e.length>t.length;return N.length?(0,s.jsx)(E,{repos:N}):k?(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(d.t,{icon:"search",title:"No matching jobs",description:n?(0,s.jsxs)("div",{children:["No jobs matching ",(0,s.jsx)("strong",{children:r})," were found in the selected code locations"]}):(0,s.jsxs)("div",{children:["No jobs matching ",(0,s.jsx)("strong",{children:r})," were found in your definitions"]})})}):(0,s.jsx)(l.x,{padding:{top:20},children:(0,s.jsx)(d.t,{icon:"search",title:"No jobs",description:n?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})})()]})},P=e=>{if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];let t=e.workspaceOrError.locationEntries.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,pipelines:s}=t,i=(0,z.kQ)(r,e.name),o=s.filter(e=>{let{name:t}=e;return!(0,m.pv)(t)}).map(e=>({isJob:e.isJob,name:e.name}));o.length>0&&n.push({repoAddress:i,jobs:o})}return(0,A.S)(n)},$=(0,o.Ps)(M(),p.B)},22950:function(e,t,n){n.r(t),n.d(t,{OverviewRoot:function(){return e7},default:function(){return te}});var r=n(52322),s=n(7267),i=n(38491),o=n(14934),l=n(2784),a=n(79106),c=n(74159),d=n(16629),u=n(60129),h=n(11452),x=n(43212),p=n(39013),j=n(46100),m=n(60603),g=n(35292),f=n(88510),v=n(47933),w=n(35505),y=n(23399),b=n(16336),C=n(69737),k=n(99048),N=n(98705),O=n(44900),T=n(46318),L=n(79342),E=n(32319),A=n(75442),I=n(20171),S=n(4378),R=n(79059),_=n(92322),z=n(17008),M=n(65822),F=n(10539);let P=e=>{let{Header:t,TabButton:n}=e;(0,C.Px)(),(0,I.j)("Overview | Assets");let{assets:s,query:i,error:u,loading:h}=(0,E.Zg)(),x=(0,b.bT)({refresh:i,intervalMs:b.dT,leading:!0}),p=l.useMemo(()=>s?function(e){let t={};return e.forEach(e=>{if(!e.definition)return;let n=e.definition.groupName,r=e.definition.repository.name,s="".concat(n,"||").concat(r),i=t[s]||{groupName:n,repositoryName:r,assets:[]};i.assets.push(e),t[s]=i}),Object.values(t)}(s):[],[s]),[j,m]=(0,S.q)({queryKey:"q",decode:e=>e.searchQuery?JSON.parse(e.searchQuery):"",encode:e=>({searchQuery:e?JSON.stringify(e):void 0})}),g=l.useMemo(()=>""===j?p:p.filter(e=>(e.groupName||q).toLowerCase().includes(j.toLowerCase())||e.repositoryName.toLowerCase().includes(j.toLowerCase())),[p,j]),w=l.useMemo(()=>{var e;return null!==(e=g.flatMap(e=>e.assets.map(e=>e.key)))&&void 0!==e?e:[]},[g]),{liveDataByNode:N}=(0,k.NY)(w,"OverviewAssetsRoot"),O=(0,_.se)("OverviewAssetsRoot"),T=Object.keys(N).length===w.length;l.useEffect(()=>{T&&O.endTrace()},[T,O]);let L=l.useRef(null),A=(0,f.MG)({count:g.length,getScrollElement:()=>L.current,estimateSize:()=>82,overscan:5}),R=A.getTotalSize(),M=A.getVirtualItems();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1},children:[(0,r.jsx)(t,{refreshState:x}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",gap:12,grow:0},children:[(0,r.jsx)(n,{selected:"assets"}),(0,r.jsx)(c.oi,{value:j,onChange:e=>{m(e.target.value)},placeholder:"Filter asset groups…"})]}),(0,r.jsx)(o.x,{padding:{horizontal:24,vertical:16},border:"top",children:(0,r.jsx)(d.b,{intent:"info",title:"This Assets tab will be removed in an upcoming release.",description:(0,r.jsxs)(r.Fragment,{children:["Use the ",(0,r.jsx)(v.rU,{to:"/asset-groups",children:"global asset lineage page"})," to view grouped asset status details."]})})})]}),h?(0,r.jsx)(o.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(a.$,{purpose:"page"})}):u?(0,r.jsx)(o.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(y.T9,{error:u})}):(0,r.jsx)(o.x,{flex:{direction:"column"},style:{overflow:"hidden"},children:(0,r.jsxs)(z.W2,{ref:L,children:[(0,r.jsx)(U,{}),(0,r.jsx)(z.Nh,{$totalHeight:R,children:M.map(e=>{let{index:t,key:n,size:s,start:i}=e,o=g[t];return(0,r.jsx)(J,{start:i,height:s,group:o},n)})})]})})]})},$="5fr 1fr 1fr 1fr 1fr",U=()=>(0,r.jsxs)(z.VJ,{templateColumns:$,sticky:!0,children:[(0,r.jsx)(z.qN,{children:"Group name"}),(0,r.jsx)(z.qN,{children:"Missing"}),(0,r.jsx)(z.qN,{children:"Failed/Overdue"}),(0,r.jsx)(z.qN,{children:"In progress"}),(0,r.jsx)(z.qN,{children:"Materialized"})]}),q="Ungrouped Assets";function J(e){var t,n;let{height:s,start:i,group:c}=e,d=l.useMemo(()=>c.assets.map(e=>({path:e.key.path})),[c.assets]),{liveDataByNode:j}=(0,k.NY)(d),m=(0,_.se)("OverviewAssetsRoot:GroupBatch"),g=l.useMemo(()=>(0,T.s)(c.assets,j),[j,c.assets]),f=null===(n=c.assets.find(e=>{var t;return null===(t=e.definition)||void 0===t?void 0:t.repository}))||void 0===n?void 0:null===(t=n.definition)||void 0===t?void 0:t.repository,w=(0,M.kQ)((null==f?void 0:f.name)||"",(null==f?void 0:f.location.name)||""),{containerProps:y,viewport:b}=(0,u.S)(),C=d.length!==Object.keys(j).length,O=C?"":"0";return l.useEffect(()=>{C||m.endTrace()},[m,C]),(0,r.jsx)(z.X2,{$height:s,$start:i,children:(0,r.jsxs)(Q,{border:"bottom",children:[(0,r.jsx)(B,{children:(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",grow:1},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",gap:2,grow:1},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8},children:[(0,r.jsx)(h.JO,{name:"asset_group"}),c.groupName?(0,r.jsx)(v.rU,{style:{fontWeight:700},to:(0,F.$U)(w,"/asset-groups/".concat(c.groupName)),children:c.groupName}):q]}),(0,r.jsx)("div",{...y,children:(0,r.jsx)(V,{maxWidth:b.width,children:(0,r.jsx)(R.b,{repoAddress:w,showRefresh:!1})})})]}),(0,r.jsx)(o.x,{flex:{direction:"column",justifyContent:"center"},children:C?(0,r.jsx)(a.$,{purpose:"body-text"}):null})]})}),(0,r.jsx)(B,{children:g.missing.length?(0,r.jsx)(W,{assets:g.missing,getCount:e=>{let{status:t}=e;return t.case===N.KB.PARTITIONS_MISSING&&t.numMissing||0},adjective:"missing",children:(0,r.jsx)(x.V,{intent:"none",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(p.im()),borderRadius:"50%"}}),g.missing.length]})})}):O}),(0,r.jsx)(B,{children:g.failed.length?(0,r.jsx)(W,{assets:g.failed,getCount:e=>{let{status:t}=e;return t.case===N.KB.PARTITIONS_FAILED&&t.numFailed||0},adjective:"failed",children:(0,r.jsx)(x.V,{intent:"danger",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"10px solid red",display:"inline-block"}}),g.failed.length]})})}):O}),(0,r.jsx)(B,{children:g.inprogress.length?(0,r.jsx)(W,{assets:g.inprogress,getCount:e=>{let{status:t}=e;return t.case===N.KB.MATERIALIZING&&t.numMaterializing||0},adjective:"materializing",children:(0,r.jsx)(x.V,{intent:"primary",icon:"spinner",children:g.inprogress.length})}):O}),(0,r.jsx)(B,{children:g.successful.length?(0,r.jsx)(W,{assets:g.successful,getCount:e=>{let{status:t}=e;return t.case===N.KB.PARTITIONS_MATERIALIZED&&t.numMaterialized||0},adjective:"materialized",children:(0,r.jsx)(x.V,{intent:"success",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{backgroundColor:p.fA(),width:"10px",height:"10px",borderRadius:"50%"}}),g.successful.length]})})}):O})]})})}let Q=(0,w.ZP)(o.x).withConfig({componentId:"sc-5a3ca5ca-0"})(["display:grid;grid-template-columns:",";height:100%;> *{vertical-align:middle;}"],$),B=e=>{let{children:t}=e;return(0,r.jsx)(z.E5,{style:{color:p.Ep()},children:(0,r.jsx)(o.x,{flex:{direction:"row",alignItems:"center",grow:1},children:t})})},V=w.ZP.div.withConfig({componentId:"sc-5a3ca5ca-1"})(["font-size:12px;pointer-events:none;a{color:",";pointer-events:none;max-width:",";}"],p.$(),e=>{let{maxWidth:t}=e;return t?"unset":"".concat(t,"px")});function W(e){let{assets:t,children:n,getCount:s,adjective:i}=e;return(0,r.jsx)(G,{children:(0,r.jsx)(j.P,{items:t,itemPredicate:(e,t)=>(0,O.ll)(t.asset.key).toLocaleLowerCase().includes(e.toLocaleLowerCase()),itemRenderer:e=>{let t=s(e);return(0,r.jsx)(D,{to:(0,A.p)(e.asset.key),target:"_blank",children:(0,r.jsx)(m.sN,{text:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)("div",{style:{paddingLeft:"4px"},children:(0,r.jsx)(h.JO,{name:"asset"})}),(0,r.jsx)("div",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,O.ll)(e.asset.key)}),t&&t>0?(0,r.jsxs)(g.YS,{style:{color:p.$()},children:[(0,L._e)(t)," ",i]}):null]})},(0,O.ll)(e.asset.key))})},onItemSelect:()=>{},children:n})})}let G=w.ZP.div.withConfig({componentId:"sc-5a3ca5ca-2"})(["cursor:pointer;&:hover{font-weight:600;}"]),D=(0,w.ZP)(v.rU).withConfig({componentId:"sc-5a3ca5ca-3"})(["&:hover{text-decoration:none;}"]);var K=n(74580);let H=(0,n(65297).f)("OverviewPageAlerts");var Z=n(73407),X=n(49438),Y=n(87171),ee=n(39268),et=n(71348),en=n(89918);let er=e=>{let{refreshState:t,tab:n}=e,{flagSettingsPage:s}=(0,X.gV)(),i=(0,et.dx)(),c=(0,ee.I)(),{enableAssetHealthOverviewPreview:d}=(0,l.useContext)(Y.G);return(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,r.jsxs)(Z.mQ,{selectedTabId:n,children:[(0,r.jsx)(en.f,{id:"activity",title:"Timeline",to:"/overview/activity"}),d&&(0,r.jsx)(en.f,{id:"asset-health",title:"Asset health",to:"/overview/asset-health"}),s?null:(0,r.jsx)(en.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),s?null:(0,r.jsx)(en.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),s?null:(0,r.jsx)(en.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),s||"has-global-amp"!==c?null:(0,r.jsx)(en.f,{id:"amp",title:(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)("div",{children:"Auto-materialize"}),i.loading?(0,r.jsx)(a.$,{purpose:"body-text"}):(0,r.jsx)("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:!1===i.paused?p.L$():p.md()}})]}),to:"/overview/automation"}),(0,r.jsx)(en.f,{id:"resources",title:"Resources",to:"/overview/resources"}),s?null:(0,r.jsx)(en.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),t?(0,r.jsx)(o.x,{padding:{bottom:8},children:(0,r.jsx)(b.xi,{refreshState:t})}):null]})},es=e=>{let{tab:t,queryData:n,refreshState:s,...i}=e;return(0,r.jsx)(K.m,{title:(0,r.jsx)(g.X6,{children:"Overview"}),tabs:(0,r.jsxs)(o.x,{flex:{direction:"column",gap:8},children:[(0,r.jsx)(er,{tab:t,queryData:n,refreshState:s}),(0,r.jsx)(H,{})]}),...i})};var ei=n(51484),eo=n(43111),el=n(43250),ea=n(34080),ec=n(30001);let ed=e=>{let t=(0,l.useCallback)(t=>{switch(t){case"1":case"6":case"12":case"24":return t;default:return e}},[e]),[n,r]=(0,ec.U)("dagster.run-timeline-hour-window",t),s=(0,l.useCallback)(t=>{r(t||e)},[e,r]);return(0,l.useMemo)(()=>[n,s],[n,s])};var eu=n(73235),eh=n(40794),ex=n(89130),ep=n(59351),ej=n(33182),em=n(77539),eg=n(88257);function ef(){let e=(0,eu._)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]);return ef=function(){return e},e}let ev=(0,ex.Ps)(ef());var ew=n(34219),ey=n(22563);function eb(){let e=(0,eu._)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return eb=function(){return e},e}let eC=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[n,r]=e,s=n/1e3,i=r/1e3,o=(0,eh.a)(eN,{notifyOnNetworkStatusChange:!0,fetchPolicy:"no-cache",variables:{inProgressFilter:{...t,statuses:[eg.VOA.CANCELING,eg.VOA.STARTED],createdBefore:i},terminatedFilter:{...t,statuses:Array.from(ep.cv),createdBefore:i,updatedAfter:s},tickCursor:s,ticksUntil:i}});(0,ew.Hu)(o,"RunTimelineQuery");let{data:a,previousData:c,loading:d}=o,u=d&&!a,{unterminated:h,terminated:x,workspaceOrError:p}=a||c||{},j=(0,l.useMemo)(()=>{let e={},t=Date.now();return[...(null==h?void 0:h.__typename)==="Runs"?h.results:[],...(null==x?void 0:x.__typename)==="Runs"?x.results:[]].forEach(s=>{if(!s.startTime||!s.repositoryOrigin||!(0,em.a)({start:n,end:r},{start:1e3*s.startTime,end:s.endTime?1e3*s.endTime:t}))return;let i=ek({name:s.repositoryOrigin.repositoryName,location:s.repositoryOrigin.repositoryLocationName},s.pipelineName);e[i]=[...e[i]||[],{id:s.id,status:s.status,startTime:1e3*s.startTime,endTime:s.endTime?1e3*s.endTime:t}]}),e},[r,h,x,n]),m=(0,l.useMemo)(()=>{if(!p||"Workspace"!==p.__typename)return[];let e=[];for(let s of p.locationEntries){var t;if("WorkspaceLocationEntry"!==s.__typename||(null===(t=s.locationOrLoadError)||void 0===t?void 0:t.__typename)!=="RepositoryLocation")continue;let i=Date.now();for(let t of s.locationOrLoadError.repositories){let o=(0,M.kQ)(t.name,s.locationOrLoadError.name);for(let s of t.pipelines){let l=(t.schedules||[]).filter(e=>e.pipelineName===s.name),a=[];for(let e of l)e.scheduleState.status===eg.ynu.RUNNING&&e.futureTicks.results.forEach(t=>{let{timestamp:s}=t,o=1e3*s;o>i&&(0,em.a)({start:n,end:r},{start:o,end:o})&&a.push({id:"".concat(e.pipelineName,"-future-run-").concat(s),status:"SCHEDULED",startTime:o,endTime:o+5e3})});let c=(0,O.pv)(s.name),d=ek(o,s.name),u=c?"Ad hoc materializations":s.name,h=j[d]||[];if(!a.length&&!h.length)continue;let x=[...h,...a];if(c){let t=e.find(e=>"asset"===e.jobType&&e.repoAddress===o);if(t){t.runs.push(...x);continue}}e.push({key:d,jobName:u,jobType:c?"asset":"job",repoAddress:o,path:(0,F.jT)({repoName:o.name,repoLocation:o.location,pipelineName:s.name,isJob:s.isJob}),runs:[...h,...a]})}}}let s=e.reduce((e,t)=>{let n=t.runs.map(e=>e.startTime);return{...e,[t.key]:Math.min(...n)}},{});return e.sort((e,t)=>s[e.key]-s[t.key])},[p,j,n,r]);return(0,l.useMemo)(()=>({jobs:m,initialLoading:u,queryData:o}),[u,m,o])},ek=(e,t)=>"".concat(t,"-").concat((0,ey.Uz)(e)),eN=(0,ex.Ps)(eb(),ej.$X,ev);var eO=n(46146);let eT=e=>{switch(e){case"1":return 36e5;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},eL=e=>{let{Header:t,TabButton:n}=e;(0,C.Px)(),(0,I.j)("Overview | Timeline");let s=(0,_.se)("OverviewTimelineRoot"),{allRepos:a,visibleRepos:d}=l.useContext(eO.C5),[u,h]=ed("12"),[x,p]=l.useState(()=>Date.now()),[j,m]=l.useState(()=>0),[g,f]=(0,S.q)({queryKey:"search",defaults:{search:""}});l.useEffect(()=>{let e=setInterval(()=>{p(Date.now())},6e4);return()=>{clearInterval(e)}},[u]);let v=l.useCallback(()=>{m(e=>e-eT(u))},[u]),w=l.useCallback(()=>{m(e=>e+eT(u))},[u]),y=l.useCallback(()=>{m(0)},[]),k=l.useMemo(()=>[x-36e5*Number(u)+j,x+36e5+j],[u,x,j]),{jobs:N,initialLoading:O,queryData:T}=eC(k),L=(0,b.C4)(T,b.dT);l.useEffect(()=>{O||s.endTrace()},[O,s]);let E=l.useMemo(()=>{let e=g.toLocaleLowerCase().trim();return new Set(d.flatMap(t=>{let n=(0,M.kQ)(t.repository.name,t.repositoryLocation.name);return t.repository.pipelines.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)}).map(e=>ek(n,e.name))}))},[d,g]),A=l.useMemo(()=>N.filter(e=>{let{key:t}=e;return E.has(t)}),[N,E]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t,{refreshState:L}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[n&&(0,r.jsx)(n,{selected:"timeline"}),a.length>1&&(0,r.jsx)(el.C,{}),(0,r.jsx)(c.oi,{icon:"search",value:g,onChange:e=>f(e.target.value),placeholder:"Filter by job name…",style:{width:"200px"}})]}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,r.jsx)(ei.h,{activeItems:new Set([u]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:e=>h(e)}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(i.zx,{onClick:v,children:"←"}),(0,r.jsx)(i.zx,{onClick:y,children:"Now"}),(0,r.jsx)(i.zx,{onClick:w,children:"→"})]})]})]}),(0,r.jsx)(eo.S,{region:"timeline",children:(0,r.jsx)(ea.q,{loading:O,range:k,jobs:A})})]})};var eE=n(17872),eA=n(38267);let eI=()=>{(0,I.j)("Overview | Activity");let e=l.useCallback(e=>{let{refreshState:t}=e;return(0,r.jsx)(es,{tab:"activity",refreshState:t})},[]),[t,n]=(0,ec.U)("overview-activity-tab",e=>["timeline","assets"].includes(e)?e:"timeline"),{enableAssetHealthOverviewPreview:a}=l.useContext(Y.G),c=a?"timeline":t,d=l.useCallback(e=>{let{selected:t}=e;return a?null:(c!==t&&n(t),(0,r.jsxs)(i.zH,{children:[(0,r.jsx)(eA.Q1,{$active:"timeline"===t,to:"/overview/activity/timeline",children:"Timeline"}),(0,r.jsx)(eA.Q1,{$active:"assets"===t,to:"/overview/activity/assets",children:"Assets"})]}))},[c,n,a]);return(0,r.jsx)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:(0,r.jsxs)(s.rs,{children:[!a&&(0,r.jsx)(eE.A,{path:"/overview/activity/assets",children:(0,r.jsx)(P,{Header:e,TabButton:d})}),(0,r.jsx)(eE.A,{path:"/overview/activity/timeline",children:(0,r.jsx)(eL,{Header:e,TabButton:d})}),(0,r.jsx)(eE.A,{path:"*",render:l.useCallback(()=>"timeline"===c?(0,r.jsx)(s.l_,{to:"/overview/activity/timeline"}):(0,r.jsx)(s.l_,{to:"/overview/activity/assets"}),[c])})]})})};var eS=n(63065);let eR=()=>((0,C.Px)(),(0,I.j)("Overview | Jobs"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(K.m,{title:(0,r.jsx)(g.X6,{children:"Overview"}),tabs:(0,r.jsx)(er,{tab:"jobs"})}),(0,r.jsx)(eS.e,{})]}));var e_=n(37483),ez=n(35002),eM=n(22921),eF=n(3922),eP=n(98956),e$=n(50646),eU=n(83738);let eq=e=>{let{repos:t}=e,n=(0,l.useRef)(null),s=(0,l.useMemo)(()=>t.map(e=>{let{repoAddress:t}=e;return(0,ey.Uz)(t)}),[t]),{expandedKeys:i,onToggle:o,onToggleAll:a}=(0,e$.N)(eM.y,s),c=(0,l.useMemo)(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,resources:r}=t;e.push({type:"header",repoAddress:n,resourceCount:r.length});let s=(0,ey.Uz)(n);i.includes(s)&&r.forEach(t=>{e.push({type:"resource",repoAddress:n,...t})})}),e},[t,i]),d=(0,eP.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),u=(0,f.MG)({count:c.length,getScrollElement:()=>n.current,estimateSize:e=>{let t=c[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(z.W2,{ref:n,children:[(0,r.jsx)(eF.f,{}),(0,r.jsx)(z.Nh,{$totalHeight:h,children:p.map(e=>{let{index:t,key:n,size:s,start:l}=e,u=c[t];return"header"===u.type?(0,r.jsx)(eU.vG,{repoAddress:u.repoAddress,height:s,start:l,onToggle:o,onToggleAll:a,expanded:i.includes((0,ey.Uz)(u.repoAddress)),showLocation:d.has(u.repoAddress.name),rightElement:(0,r.jsx)(ez.u,{content:1===u.resourceCount?"1 resource":"".concat(u.resourceCount," resources"),placement:"top",children:(0,r.jsx)(x.V,{children:u.resourceCount})})},n):(0,r.jsx)(eF.K,{height:s,start:l,...u},n)})})]})})};var eJ=n(907),eQ=n(49455),eB=n(78491),eV=n(71662),eW=n(73658);function eG(){let e=(0,eu._)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  id\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return eG=function(){return e},e}let eD=()=>{(0,C.Px)(),(0,I.j)("Overview | Resources");let{allRepos:e,visibleRepos:t,loading:n}=(0,l.useContext)(eO.C5),[s,i]=(0,S.q)({queryKey:"search",defaults:{search:""}}),d=e.length,u=(0,eh.a)(eH,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:h,loading:x}=u;(0,ew.Hu)(u,"OverviewResourcesQuery");let j=(0,b.C4)(u,b.dT),m=(0,l.useMemo)(()=>{let e=(0,eQ.S)(t);return eK(h).filter(t=>{let{repoAddress:n}=t;return e.has((0,ey.Uz)(n))})},[h,t]),g=s.trim().toLocaleLowerCase(),f=g.length>0,v=(0,l.useMemo)(()=>{let e=g.toLocaleLowerCase();return m.map(t=>{let{repoAddress:n,resources:r}=t;return{repoAddress:n,resources:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{resources:t}=e;return t.length>0})},[m,g]),w=n&&!d||x&&!h;return(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(es,{tab:"resources",refreshState:j}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[d>1?(0,r.jsx)(el.C,{}):null,(0,r.jsx)(c.oi,{icon:"search",value:s,rightElement:w?(0,r.jsx)(eW.W,{tooltipContent:"Loading resources…"}):void 0,onChange:e=>i(e.target.value),placeholder:"Filter by resource name…",style:{width:"340px"}})]}),x&&!d?(0,r.jsx)(o.x,{padding:64,children:(0,r.jsx)(a.$,{purpose:"page"})}):(()=>{if(x&&!h)return(0,r.jsx)(o.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading resources…"})]})});let n=e.length>t.length;return v.length?(0,r.jsx)(eq,{repos:v}):f?(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(e_.t,{icon:"search",title:"No matching resources",description:n?(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:s})," were found in the selected code locations"]}):(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:s})," were found in your definitions"]})})}):(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(e_.t,{icon:"search",title:"No resources",description:n?"No resources were found in the selected code locations":"No resources were found in your definitions"})})})()]})},eK=e=>{if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];let t=e.workspaceOrError.locationEntries.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,allTopLevelResourceDetails:s}=t,i=(0,M.kQ)(r,e.name);s.length>0&&n.push({repoAddress:i,resources:s})}return(0,eJ.S)(n)},eH=(0,ex.Ps)(eG(),eB.B,eV.L);var eZ=n(6685);let eX=()=>((0,C.Px)(),(0,I.j)("Overview | Schedules"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(es,{tab:"schedules"}),(0,r.jsx)(eZ.z,{})]}));var eY=n(80089);let e0=()=>((0,C.Px)(),(0,I.j)("Overview | Sensors"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(es,{tab:"sensors"}),(0,r.jsx)(eY.n,{})]}));var e1=n(49308),e2=n(26954),e3=n(71406);let e4=()=>{let e=(0,ee.I)();switch(e){case"unknown":return(0,r.jsx)("div",{});case"has-global-amp":return(0,r.jsx)(e5,{});case"has-sensor-amp":return(0,r.jsx)(s.l_,{to:"/overview/sensors"});default:(0,e3.UT)(e)}},e5=()=>((0,C.Px)(),(0,I.j)("Overview | Auto-materialize"),(0,r.jsxs)(e1.T,{children:[(0,r.jsx)(es,{tab:"amp"}),(0,r.jsx)(e2.$,{})]}));var e6=n(7870);let e9=()=>((0,C.Px)(),(0,I.j)("Overview | Backfills"),(0,r.jsxs)(e1.T,{children:[(0,r.jsx)(es,{tab:"backfills"}),(0,r.jsx)(e6.A,{})]}));var e8=n(62512);let e7=()=>{let{flagSettingsPage:e}=(0,X.gV)();return(0,r.jsxs)(s.rs,{children:[(0,r.jsx)(eE.A,{path:"/overview/activity",children:(0,r.jsx)(eI,{})}),(0,r.jsx)(eE.A,{path:"/overview/jobs",render:()=>e?(0,r.jsx)(s.l_,{to:"/jobs"}):(0,r.jsx)(eR,{})}),(0,r.jsx)(eE.A,{path:"/overview/schedules",render:()=>e?(0,r.jsx)(s.l_,{to:"/automation/schedules"}):(0,r.jsx)(eX,{})}),(0,r.jsx)(eE.A,{path:"/overview/sensors",render:()=>e?(0,r.jsx)(s.l_,{to:"/automation/sensors"}):(0,r.jsx)(e0,{})}),(0,r.jsx)(eE.A,{path:"/overview/automation",render:()=>e?(0,r.jsx)(s.l_,{to:"/automation"}):(0,r.jsx)(e4,{})}),(0,r.jsx)(eE.A,{path:"/overview/backfills/:backfillId",render:t=>{let{match:n}=t;return e?(0,r.jsx)(s.l_,{to:"/automation/backfills/".concat(n.params.backfillId)}):(0,r.jsx)(e8.t4,{})}}),(0,r.jsx)(eE.A,{path:"/overview/backfills",exact:!0,render:()=>e?(0,r.jsx)(s.l_,{to:"/automation/backfills"}):(0,r.jsx)(e9,{})}),(0,r.jsx)(eE.A,{path:"/overview/resources",children:(0,r.jsx)(eD,{})}),(0,r.jsx)(eE.A,{path:"*",render:()=>(0,r.jsx)(s.l_,{to:"/overview/activity"})})]})};var te=e7}}]);
//# sourceMappingURL=2950.d8eb552a58c87109.js.map