import{d as A,i as V,b as g,k as me,c as f,o as S,e as D,f as a,t as E,m as G,_ as R,S as fe,r as w,U as P,H as N,V as B,Q,W as _e,I as ge,w as X,v as Y,z as J,A as he,h as ye,X as Ce,F as be,s as Ie,n as Z,p as ee,j as te,u as q,l as $e,q as Pe,R as Ee}from"./index-B8VEmG49.js";const Se={class:"ChildlessPlaceholder"},Te={class:"content"},De={class:"title"},Me={key:0,class:"message"},Be=10,we=A({__name:"ChildlessPlaceholder",props:{componentId:{}},setup(p){const o=V(g.core),m=p,{componentId:l}=me(m),s=f(()=>o.getComponentById(l.value)),T=f(()=>o.getComponentDefinition(s.value.type)),c=(h,y)=>{const r=h.map(I=>o.getComponentDefinition(I)).map(I=>I==null?void 0:I.name);return`${r.slice(0,-1).join(", ")} ${r.length>1?y:""} ${r.at(-1)}`},$=f(()=>{const h=o.getContainableTypes(l.value);let y;return h.length<=Be&&(y=`You can add ${c(h,"and")} components`),y});return(h,y)=>(S(),D("div",Se,[a("div",Te,[a("div",De,[a("h3",null,"Empty "+E(T.value.name),1)]),$.value?(S(),D("div",Me,E($.value),1)):G("",!0)])]))}}),xe=R(we,[["__scopeId","data-v-d3acbdaf"]]),Fe={class:"RenderError"},Ve={class:"title"},ke={class:"message"},Ae=A({__name:"RenderError",props:{componentType:{},message:{}},setup(p){const o=p;return(m,l)=>(S(),D("div",Fe,[a("div",Ve,[a("h2",null,"Error rendering "+E(o.componentType),1)]),a("div",ke,E(o.message),1)]))}}),Re={props:["componentId","instancePath","instanceData"],setup(p){const o=V(g.core),m=V(g.builderManager),l=p.componentId,s=f(()=>o.getComponentById(l)),T=fe(s.value.type),c=p.instancePath,$=p.instanceData,{getEvaluatedFields:h,isComponentVisible:y}=Q(o),t=h(c),r=f(()=>o.getComponents(l,{sortedByPosition:!0})),d=f(()=>!!m&&m.getMode()!="preview"),I=f(()=>d.value&&!s.value.isCodeManaged&&s.value.type!=="root"),x=(e,n)=>(e?o.getContainableTypes(e):["root"]).includes(n),M=w(!1),ne=f(()=>o.getUserFunctions()),oe=()=>{if(!(r.value.length>0))return B(xe,{componentId:s.value.id})},W=(e,n=0,u={})=>B(se,{componentId:e,key:`${e}:${n}`,instancePath:[...c,{componentId:e,instanceNumber:n}],instanceData:[...$,w(null)],...u}),ae=e=>n=>{if(!x(l,n.type)&&e==="default")return!0;const i=o.getComponentDefinition(n.type).slot??"default";return i==="*"||i===e},K=(e=0,n="default",u=()=>!0,i=!1)=>{const v=_=>!d.value||i?[]:[B("div",{"data-streamsync-slot-of-id":l,"data-streamsync-position":_})],C=r.value.filter(ae(n)).filter(u),b=C.filter(_=>!_.isCodeManaged).map(_=>W(_.id,e,{contextSlot:n})),F=C.filter(_=>_.isCodeManaged).map(_=>W(_.id,e,{contextSlot:n}));return[...v(0),...b.map((_,k)=>[_,v(k+1)]).flat(),...F]},z=(e=>e.map(n=>`${n.componentId}:${n.instanceNumber}`).join(","))(c);P(g.evaluatedFields,t),P(g.componentId,l),P(g.isBeingEdited,d),P(g.isDisabled,M),P(g.instancePath,c),P(g.instanceData,$),P(g.renderProxiedComponent,W),P(g.getChildrenVNodes,K),P(g.flattenedInstancePath,z);const le={"data-streamsync-id":l,"data-streamsync-instance-path":z},j=w(!1);N(()=>(m==null?void 0:m.getSelectedId())==l,e=>{j.value=e}),N(()=>t,()=>{j.value=!1},{deep:!0});const H=f(()=>r.value.length==0),re=f(()=>y(l,c)),ce=(e,n)=>{if(!e.startsWith("$")&&!n)return i=>{let v=!1;ne.value.some(C=>C.name==e&&C.args.includes("payload"))&&(v=!0),o.forwardEvent(i,c,v)};if(e.startsWith("$goToPage_")){const i=e.substring(10);return v=>o.setActivePageFromKey(i)}return null},ie=f(()=>{const e={},n=Object.keys(s.value.handlers??{}),u=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...n,...u])).forEach(v=>{var F;const C=`on${v.charAt(0).toUpperCase()}${v.slice(1)}`,b=v===((F=s.value.binding)==null?void 0:F.eventType);e[C]=_=>{var O,U;b&&o.forwardEvent(_,c,!0);const k=(O=s.value.handlers)==null?void 0:O[v];k&&((U=ce(k,b))==null||U(_))}}),e}),de=f(()=>{var u;const e=(u=o.getComponentDefinition(s.value.type))==null?void 0:u.fields;if(!e)return;const n={};return Object.keys(e).forEach(i=>{e[i].applyStyleVariable&&t[i]&&(n[`--${i}`]=t[i].value)}),n}),ue=f(()=>{var C;const e="cssClasses",n=(C=o.getComponentDefinition(s.value.type))==null?void 0:C.fields;if(!n||!n[e]||!t[e])return;const u=t[e].value,i=u==null?void 0:u.split(" ").map(b=>b.trim()),v={};return i.forEach(b=>{v[b]=!0}),v}),pe=function(){return{class:{[`ss-type-${s.value.type}`]:!0,component:!0,childless:H.value,selected:j.value,disabled:M.value,beingEdited:d.value,...ue.value},style:{...de.value,...re.value?{}:{display:"none"}},...le,...M.value?[]:ie.value,draggable:I.value}},ve=(e,n)=>d.value?B(Ae,{...e,componentType:s.value.type,message:n}):B("div");return()=>{const e=d.value?oe():void 0,n=({instanceNumber:i=0,slotName:v="default",componentFilter:C=()=>!0,positionlessSlot:b=!1})=>H.value?b?void 0:e:K(i,v,C,b),u={...pe()};return x(s.value.parentId,s.value.type)?B(T,u,{default:n}):ve(u,"Parent is not suitable for this component")}}},se=R(Re,[["__scopeId","data-v-d7a0a5d8"]]),L=p=>(ee("data-v-8ad2310e"),p=p(),te(),p),Le=L(()=>a("i",{class:"icon material-symbols-outlined"}," notifications ",-1)),We={class:"counter"},je=L(()=>a("div",{class:"balloonFlash"},null,-1)),Ne={class:"main"},Ke={class:"clearContainer"},ze=L(()=>a("i",{class:"material-symbols-outlined"}," clear_all ",-1)),He=L(()=>a("i",{class:"material-symbols-outlined"}," exclamation ",-1)),Oe=[He],Ue={class:"content"},Xe={class:"title"},Ye={class:"time"},qe={class:"message"},Ge=100,Qe=A({__name:"RendererNotifications",setup(p){const o=V(g.core),m=w(!1),l=w(null),s=_e([]),T=h=>{const{type:y,title:t,message:r,code:d}=h;s.unshift({type:y,title:t,message:r,code:d,timestampReceived:new Date}),s.splice(Ge),l.value.classList.remove("alert"),l.value.offsetWidth,l.value.classList.add("alert")};ge(()=>{o.addMailSubscription("notification",T)});const c=()=>{s.length!=0&&(m.value=!m.value)},$=()=>{s.splice(0),m.value=!1};return(h,y)=>X((S(),D("div",{class:"RendererNotifications colorTransformer",onClick:c},[a("div",{ref_key:"balloon",ref:l,class:"balloon",title:"Toggle notifications"},[Le,a("div",We,E(s.length),1)],512),je,X(a("div",Ne,[a("div",Ke,[J(Ce,{onClick:$},{default:he(()=>[ze,ye(" Clear all ")]),_:1})]),(S(!0),D(be,null,Ie(s,(t,r)=>(S(),D("div",{key:r,class:"notification"},[a("div",{class:Z(["icon",t.type])},Oe,2),a("div",Ue,[a("header",null,[a("strong",Xe,E(t.title),1),a("span",Ye,E(t.timestampReceived.toLocaleTimeString()),1)]),a("div",qe,E(t.message),1)])]))),128))],512),[[Y,m.value]])],512)),[[Y,s.length>0]])}}),Je=R(Qe,[["__scopeId","data-v-8ad2310e"]]),Ze=p=>(ee("data-v-a7a2409c"),p=p(),te(),p),et=Ze(()=>a("div",{class:"loadingBar"},null,-1)),tt={class:"rootComponentArea"},st=A({__name:"ComponentRenderer",setup(p){const o=V(g.core),m=Q(o),l=o.getComponentById("root");l||console.error("No root component found.");const s=[{componentId:"root",instanceNumber:0}],T=[w(null)],c=m.getEvaluatedFields(s),$=f(()=>{var t,r,d,I,x,M;return{"--accentColor":(t=c.accentColor)==null?void 0:t.value,"--emptinessColor":(r=c.emptinessColor)==null?void 0:r.value,"--containerBackgroundColor":(d=c.parentIdBackgroundColor)==null?void 0:d.value,"--primaryTextColor":(I=c.primaryTextColor)==null?void 0:I.value,"--secondaryTextColor":(x=c.secondaryTextColor)==null?void 0:x.value,"--separatorColor":(M=c.separatorColor)==null?void 0:M.value}}),h=f(()=>o.getFrontendMessageMap().size>0);N(()=>{var t;return(t=c.appName)==null?void 0:t.value},t=>{y(t)},{immediate:!0});function y(t){const r=o.getMode();let d;t&&r=="edit"?d=`${t} | Writer Framework | Builder`:!t&&r=="edit"?d="Writer Framework | Builder":t&&r=="run"?d=`${t}`:!t&&r=="run"&&(d="Writer Framework App"),document.title=d}return(t,r)=>(S(),D("main",{class:Z(["ComponentRenderer",{loadingActive:h.value}]),tabindex:"-1",style:Ee($.value)},[J(Je,{class:"notifications"}),et,a("div",tt,[q(l)?(S(),$e(se,{key:0,"component-id":q(l).id,"instance-path":s,"instance-data":T},null,8,["component-id"])):G("",!0),Pe(t.$slots,"default",{},void 0,!0)])],6))}}),at=R(st,[["__scopeId","data-v-a7a2409c"]]);export{at as default};
