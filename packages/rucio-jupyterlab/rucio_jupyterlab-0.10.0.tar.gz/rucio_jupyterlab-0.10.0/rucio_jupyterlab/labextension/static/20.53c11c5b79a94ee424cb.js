"use strict";(self.webpackChunkrucio_jupyterlab=self.webpackChunkrucio_jupyterlab||[]).push([[20],{2991:t=>{t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(s=n;0!=s--;)if(!t(e[s],r[s]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],r.get(s[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if((n=e.length)!=r.length)return!1;for(s=n;0!=s--;)if(e[s]!==r[s])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(o=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;0!=s--;){var a=o[s];if(!t(e[a],r[a]))return!1}return!0}return e!=e&&r!=r}},1020:(t,e,r)=>{r.r(e),r.d(e,{EAsyncActionInjectType:()=>Mt,EAsyncEndTags:()=>bt,EPostActionContext:()=>St,InjectAsyncAction:()=>Wt,InjectStoreState:()=>gt,InjectStoreStateOpt:()=>$t,PullstateContext:()=>Lt,PullstateProvider:()=>Bt,Store:()=>dt,batch:()=>Jt,createAsyncAction:()=>jt,createAsyncActionDirect:()=>Ut,createPullstateCore:()=>Nt,errorResult:()=>At,registerInDevtools:()=>Kt,setupBatch:()=>Xt,successResult:()=>Et,update:()=>vt,useInstance:()=>Ft,useLocalStore:()=>ht,useStoreState:()=>at,useStoreStateOpt:()=>lt,useStores:()=>zt});var n=r(2991),s=r.n(n),o=r(6271),a=r.n(o);function i(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function c(t){return!!t&&!!t[J]}function u(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof r&&Function.toString.call(r)===q}(t)||Array.isArray(t)||!!t[X]||!!t.constructor[X]||y(t)||v(t))}function l(t,e,r){void 0===r&&(r=!1),0===h(t)?(r?Object.keys:G)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function h(t){var e=t[J];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:y(t)?2:v(t)?3:0}function f(t,e){return 2===h(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function d(t,e){return 2===h(t)?t.get(e):t[e]}function p(t,e,r){var n=h(t);2===n?t.set(e,r):3===n?(t.delete(e),t.add(r)):t[e]=r}function y(t){return W&&t instanceof Map}function v(t){return $&&t instanceof Set}function g(t){return t.o||t.t}function b(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=Q(t);delete e[J];for(var r=G(e),n=0;n<r.length;n++){var s=r[n],o=e[s];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function S(t,e){return void 0===e&&(e=!1),_(t)||c(t)||!u(t)||(h(t)>1&&(t.set=t.add=t.clear=t.delete=C),Object.freeze(t),e&&l(t,(function(t,e){return S(e,!0)}),!0)),t}function C(){i(2)}function _(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function m(t){var e=Y[t];return e||i(18,t),e}function O(){return F}function P(t,e){e&&(m("Patches"),t.u=[],t.s=[],t.v=e)}function w(t){k(t),t.p.forEach(A),t.p=null}function k(t){t===F&&(F=t.l)}function E(t){return F={p:[],l:F,h:t,m:!0,_:0}}function A(t){var e=t[J];0===e.i||1===e.i?e.j():e.g=!0}function R(t,e){e._=e.p.length;var r=e.p[0],n=void 0!==t&&t!==r;return e.h.O||m("ES5").S(e,t,n),n?(r[J].P&&(w(e),i(4)),u(t)&&(t=I(e,t),e.l||j(e,t)),e.u&&m("Patches").M(r[J],t,e.u,e.s)):t=I(e,r,[]),w(e),e.u&&e.v(e.u,e.s),t!==V?t:void 0}function I(t,e,r){if(_(e))return e;var n=e[J];if(!n)return l(e,(function(s,o){return U(t,n,e,s,o,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return j(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var s=4===n.i||5===n.i?n.o=b(n.k):n.o;l(3===n.i?new Set(s):s,(function(e,o){return U(t,n,s,e,o,r)})),j(t,s,!1),r&&t.u&&m("Patches").R(n,r,t.u,t.s)}return n.o}function U(t,e,r,n,s,o){if(c(s)){var a=I(t,s,o&&e&&3!==e.i&&!f(e.D,n)?o.concat(n):void 0);if(p(r,n,a),!c(a))return;t.m=!1}if(u(s)&&!_(s)){if(!t.h.F&&t._<1)return;I(t,s),e&&e.A.l||j(t,s)}}function j(t,e,r){void 0===r&&(r=!1),t.h.F&&t.m&&S(e,r)}function L(t,e){var r=t[J];return(r?g(r):t)[e]}function B(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function D(t){t.P||(t.P=!0,t.l&&D(t.l))}function H(t){t.o||(t.o=b(t.t))}function T(t,e,r){var n=y(e)?m("MapSet").N(e,r):v(e)?m("MapSet").T(e,r):t.O?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:O(),P:!1,I:!1,D:{},l:e,t,k:null,o:null,j:null,C:!1},s=n,o=Z;r&&(s=[n],o=tt);var a=Proxy.revocable(s,o),i=a.revoke,c=a.proxy;return n.k=c,n.j=i,c}(e,r):m("ES5").J(e,r);return(r?r.A:O()).p.push(n),n}function x(t){return c(t)||i(22,t),function t(e){if(!u(e))return e;var r,n=e[J],s=h(e);if(n){if(!n.P&&(n.i<4||!m("ES5").K(n)))return n.t;n.I=!0,r=N(e,s),n.I=!1}else r=N(e,s);return l(r,(function(e,s){n&&d(n.t,e)===s||p(r,e,t(s))})),3===s?new Set(r):r}(t)}function N(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return b(t)}var z,F,M="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),W="undefined"!=typeof Map,$="undefined"!=typeof Set,K="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,V=M?Symbol.for("immer-nothing"):((z={})["immer-nothing"]=!0,z),X=M?Symbol.for("immer-draftable"):"__$immer_draftable",J=M?Symbol.for("immer-state"):"__$immer_state",q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),G="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,Q=Object.getOwnPropertyDescriptors||function(t){var e={};return G(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},Y={},Z={get:function(t,e){if(e===J)return t;var r=g(t);if(!f(r,e))return function(t,e,r){var n,s=B(e,r);return s?"value"in s?s.value:null===(n=s.get)||void 0===n?void 0:n.call(t.k):void 0}(t,r,e);var n=r[e];return t.I||!u(n)?n:n===L(t.t,e)?(H(t),t.o[e]=T(t.A.h,n,t)):n},has:function(t,e){return e in g(t)},ownKeys:function(t){return Reflect.ownKeys(g(t))},set:function(t,e,r){var n=B(g(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var s=L(g(t),e),o=null==s?void 0:s[J];if(o&&o.t===r)return t.o[e]=r,t.D[e]=!1,!0;if(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}(r,s)&&(void 0!==r||f(t.t,e)))return!0;H(t),D(t)}return t.o[e]===r&&"number"!=typeof r||(t.o[e]=r,t.D[e]=!0,!0)},deleteProperty:function(t,e){return void 0!==L(t.t,e)||e in t.t?(t.D[e]=!1,H(t),D(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=g(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){i(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){i(12)}},tt={};l(Z,(function(t,e){tt[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),tt.deleteProperty=function(t,e){return Z.deleteProperty.call(this,t[0],e)},tt.set=function(t,e,r){return Z.set.call(this,t[0],e,r,t[0])};var et=new(function(){function t(t){var e=this;this.O=K,this.F=!0,this.produce=function(t,r,n){if("function"==typeof t&&"function"!=typeof r){var s=r;r=t;var o=e;return function(t){var e=this;void 0===t&&(t=s);for(var n=arguments.length,a=Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return o.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(a))}))}}var a;if("function"!=typeof r&&i(6),void 0!==n&&"function"!=typeof n&&i(7),u(t)){var c=E(e),l=T(e,t,void 0),h=!0;try{a=r(l),h=!1}finally{h?w(c):k(c)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(t){return P(c,n),R(t,c)}),(function(t){throw w(c),t})):(P(c,n),R(a,c))}if(!t||"object"!=typeof t){if((a=r(t))===V)return;return void 0===a&&(a=t),e.F&&S(a,!0),a}i(21,t)},this.produceWithPatches=function(t,r){return"function"==typeof t?function(r){for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(s))}))}:[e.produce(t,r,(function(t,e){n=t,s=e})),n,s];var n,s},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){u(t)||i(8),c(t)&&(t=x(t));var e=E(this),r=T(this,t,void 0);return r[J].C=!0,k(e),r},e.finishDraft=function(t,e){var r=(t&&t[J]).A;return P(r,e),R(void 0,r)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!K&&i(20),this.O=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}var s=m("Patches").$;return c(t)?s(t,e):this.produce(t,(function(t){return s(t,e.slice(r+1))}))},t}()),rt=et.produce,nt=et.produceWithPatches.bind(et),st=(et.setAutoFreeze.bind(et),et.setUseProxies.bind(et),et.applyPatches.bind(et));et.createDraft.bind(et),et.finishDraft.bind(et);const ot=rt;function at(t,e,r){const n=(0,o.useRef)({state:void 0,initialized:!1});n.current.initialized||(n.current.state=e?e(t.getRawState()):t.getRawState(),n.current.initialized=!0);const[,a]=(0,o.useState)(0);if((0,o.useEffect)((()=>{const r={shouldUpdate:!0};function o(){if(r.shouldUpdate){const o=e?e(t.getRawState()):t.getRawState();s()(n.current.state,o)||r.shouldUpdate&&(n.current.state=o,a((t=>t+1)))}}return t._addUpdateListener(o),o(),()=>{r.shouldUpdate=!1,t._removeUpdateListener(o)}}),null!=r?r:[]),void 0!==r){const a=(0,o.useRef)(r);s()(r,a)||(n.current.state=e(t.getRawState()))}return n.current.state}let it=0;function ct(t,e){return e.reduce(((e=t,r)=>e[r]),void 0)}function ut(t,e){const r=t.getRawState(),n=[];for(const t of e)n.push(ct(r,t));return n}function lt(t,e){const[r,n]=(0,o.useState)((()=>ut(t,e))),s=(0,o.useRef)({shouldUpdate:!0,onStoreUpdate:null,currentSubState:null,ordKey:"_"+it++});return s.current.currentSubState=r,null===s.current.onStoreUpdate&&(s.current.onStoreUpdate=function(){s.current.shouldUpdate&&n(ut(t,e))},t._addUpdateListenerOpt(s.current.onStoreUpdate,s.current.ordKey,e)),(0,o.useEffect)((()=>()=>{s.current.shouldUpdate=!1,t._removeUpdateListenerOpt(s.current.ordKey)}),[]),r}function ht(t,e){const r=(0,o.useRef)();if(null==r.current&&(r.current=new dt(t)),void 0!==e){const n=(0,o.useRef)(e);s()(e,n)||(r.current=new dt(t))}return r.current}const ft={storeOrdinal:0,batching:!1,flushStores:{}};!function(){function t(e){if(!u(e))return e;if(Array.isArray(e))return e.map(t);if(y(e))return new Map(Array.from(e.entries()).map((function(e){return[e[0],t(e[1])]})));if(v(e))return new Set(Array.from(e).map(t));var r=Object.create(Object.getPrototypeOf(e));for(var n in e)r[n]=t(e[n]);return r}function e(e){return c(e)?t(e):e}var r="add";!function(t,e){Y[t]||(Y[t]=e)}("Patches",{$:function(e,n){return n.forEach((function(n){for(var s=n.path,o=n.op,a=e,c=0;c<s.length-1;c++){var u=h(a),l=s[c];0!==u&&1!==u||"__proto__"!==l&&"constructor"!==l||i(24),"function"==typeof a&&"prototype"===l&&i(24),"object"!=typeof(a=d(a,l))&&i(15,s.join("/"))}var f=h(a),p=t(n.value),y=s[s.length-1];switch(o){case"replace":switch(f){case 2:return a.set(y,p);case 3:i(16);default:return a[y]=p}case r:switch(f){case 1:return a.splice(y,0,p);case 2:return a.set(y,p);case 3:return a.add(p);default:return a[y]=p}case"remove":switch(f){case 1:return a.splice(y,1);case 2:return a.delete(y);case 3:return a.delete(n.value);default:return delete a[y]}default:i(17,o)}})),e},R:function(t,n,s,o){switch(t.i){case 0:case 4:case 2:return function(t,n,s,o){var a=t.t,i=t.o;l(t.D,(function(t,c){var u=d(a,t),l=d(i,t),h=c?f(a,t)?"replace":r:"remove";if(u!==l||"replace"!==h){var p=n.concat(t);s.push("remove"===h?{op:h,path:p}:{op:h,path:p,value:l}),o.push(h===r?{op:"remove",path:p}:"remove"===h?{op:r,path:p,value:e(u)}:{op:"replace",path:p,value:e(u)})}}))}(t,n,s,o);case 5:case 1:return function(t,n,s,o){var a=t.t,i=t.D,c=t.o;if(c.length<a.length){var u=[c,a];a=u[0],c=u[1];var l=[o,s];s=l[0],o=l[1]}for(var h=0;h<a.length;h++)if(i[h]&&c[h]!==a[h]){var f=n.concat([h]);s.push({op:"replace",path:f,value:e(c[h])}),o.push({op:"replace",path:f,value:e(a[h])})}for(var d=a.length;d<c.length;d++){var p=n.concat([d]);s.push({op:r,path:p,value:e(c[d])})}a.length<c.length&&o.push({op:"replace",path:n.concat(["length"]),value:a.length})}(t,n,s,o);case 3:return function(t,e,n,s){var o=t.t,a=t.o,i=0;o.forEach((function(t){if(!a.has(t)){var o=e.concat([i]);n.push({op:"remove",path:o,value:t}),s.unshift({op:r,path:o,value:t})}i++})),i=0,a.forEach((function(t){if(!o.has(t)){var a=e.concat([i]);n.push({op:r,path:a,value:t}),s.unshift({op:"remove",path:a,value:t})}i++}))}(t,n,s,o)}},M:function(t,e,r,n){r.push({op:"replace",path:[],value:e}),n.push({op:"replace",path:[],value:t.t})}})}();class dt{constructor(t){if(this.updateListeners=[],this.ssr=!1,this.reactions=[],this.clientSubscriptions=[],this.reactionCreators=[],this.optimizedUpdateListeners={},this.optimizedUpdateListenerPaths={},this.optimizedListenerPropertyMap={},this._optListenerCount=0,this._patchListeners=[],t instanceof Function){const e=t();this.currentState=e,this.initialState=e,this.createInitialState=t}else this.currentState=t,this.initialState=t,this.createInitialState=()=>t;this.internalOrdId=ft.storeOrdinal++}_setInternalOptions({ssr:t,reactionCreators:e=[]}){this.ssr=t,this.reactionCreators=e,this.reactions=e.map((t=>t(this)))}_getReactionCreators(){return this.reactionCreators}_instantiateReactions(){this.reactions=this.reactionCreators.map((t=>t(this)))}_getInitialState(){return this.createInitialState()}_updateStateWithoutReaction(t){this.currentState=t}_updateState(t,e=[]){this.currentState=t,this.batchState=void 0;for(const t of this.reactions)e.push(...t());if(!this.ssr){for(const t of this.clientSubscriptions)t();if(e.length>0){const t=new Set;for(const r of e)if(this.optimizedListenerPropertyMap[r])for(const e of this.optimizedListenerPropertyMap[r])t.add(e);for(const e of t.values())this.optimizedUpdateListeners[e]&&this.optimizedUpdateListeners[e]()}this.updateListeners.forEach((t=>t()))}}_addUpdateListener(t){this.updateListeners.push(t)}_addUpdateListenerOpt(t,e,r){this.optimizedUpdateListeners[e]=t;const n=r.map((t=>t.join("~._.~")));this.optimizedUpdateListenerPaths[e]=n;for(const t of n)null==this.optimizedListenerPropertyMap[t]?this.optimizedListenerPropertyMap[t]=[e]:this.optimizedListenerPropertyMap[t].push(e);this._optListenerCount++}_removeUpdateListener(t){this.updateListeners=this.updateListeners.filter((e=>e!==t))}_removeUpdateListenerOpt(t){const e=this.optimizedUpdateListenerPaths[t];for(const r of e)this.optimizedListenerPropertyMap[r]=this.optimizedListenerPropertyMap[r].filter((e=>e!==t));delete this.optimizedUpdateListenerPaths[t],delete this.optimizedUpdateListeners[t],this._optListenerCount--}listenToPatches(t){return this._patchListeners.push(t),()=>{this._patchListeners=this._patchListeners.filter((e=>e!==t))}}subscribe(t,e){if(!this.ssr){const r=function(t,e,r){let n=e(t.getRawState());return()=>{const o=t.getRawState(),a=e(o);s()(a,n)||(r(a,o,n),n=a)}}(this,t,e);return this.clientSubscriptions.push(r),()=>{this.clientSubscriptions=this.clientSubscriptions.filter((t=>t!==r))}}return()=>{console.warn("Pullstate: Subscriptions made on the server side are not registered - so therefor this call to unsubscribe does nothing.")}}createReaction(t,e,{runNow:r=!1,runNowWithSideEffects:n=!1}={}){const o=function(t,e){return r=>{let n=t(r.getRawState());return(o=!1)=>{const a=r.getRawState(),i=t(a);if(o||!s()(i,n))if(r._optListenerCount>0){const[t,s,o]=nt(a,(t=>e(i,t,a,n)));if(r._updateStateWithoutReaction(t),n=i,s.length>0)return r._patchListeners.forEach((t=>t(s,o))),Object.keys(pt(s))}else{if(r._patchListeners.length>0){const[t,s,o]=nt(a,(t=>e(i,t,a,n)));s.length>0&&r._patchListeners.forEach((t=>t(s,o))),r._updateStateWithoutReaction(t)}else r._updateStateWithoutReaction(rt(a,(t=>e(i,t,a,n))));n=i}return[]}}}(t,e);this.reactionCreators.push(o);const a=o(this);return this.reactions.push(a),(r||n)&&(a(!0),n&&!this.ssr&&this._updateState(this.currentState)),()=>{this.reactions=this.reactions.filter((t=>t!==a))}}getRawState(){return void 0!==this.batchState?this.batchState:this.currentState}useState(t,e){return at(this,t,e)}useLocalCopyInitial(t){return ht(this.createInitialState,t)}useLocalCopySnapshot(t){return ht(this.currentState,t)}flushBatch(t=!1){void 0!==this.batchState?this.batchState!==this.currentState&&this._updateState(this.batchState):t||console.error("Pullstate: Trying to flush batch state which was never created or updated on"),this.batchState=void 0}update(t,e){if(ft.batching){void 0===this.batchState&&(this.batchState=this.currentState,ft.flushStores[this.internalOrdId]=this);const r="function"==typeof t,[n,s,o]=yt(this.batchState,t,r);s.length>0&&(this._patchListeners.length>0||e)&&(e&&e(s,o),this._patchListeners.forEach((t=>t(s,o)))),this.batchState=n}else this.batchState=void 0,vt(this,t,e)}replace(t){this._updateState(t)}applyPatches(t){!function(t,e){const r=t.getRawState(),n=st(r,e);n!==r&&t._updateState(n,Object.keys(pt(e)))}(this,t)}}function pt(t,e={}){for(const r of t){let t;for(const n of r.path)t=t?`${t}~._.~${n}`:n,e[t]=1}return e}function yt(t,e,r){return r?nt(t,(r=>e(r,t))):e.reduce((([t,e,r],n)=>{const s=nt(t,(e=>n(e,t)));return e.push(...s[1]),r.push(...s[2]),[s[0],e,r]}),[t,[],[]])}function vt(t,e,r){const n=t.getRawState(),s="function"==typeof e;if(t._optListenerCount>0){const[o,a,i]=yt(n,e,s);a.length>0&&(r&&r(a,i),t._patchListeners.forEach((t=>t(a,i))),t._updateState(o,Object.keys(pt(a))))}else{let o;if(t._patchListeners.length>0||r){const[a,i,c]=yt(n,e,s);i.length>0&&(r&&r(i,c),t._patchListeners.forEach((t=>t(i,c)))),o=a}else o=rt(n,(t=>s?e(t,n):e.reduce(((t,e)=>rt(t,(r=>e(r,t)))),n)));o!==n&&t._updateState(o)}}function gt({store:t,on:e=(t=>t),children:r}){return r(at(t,e))}var bt,St;!function(t){t.THREW_ERROR="THREW_ERROR",t.RETURNED_ERROR="RETURNED_ERROR",t.UNFINISHED="UNFINISHED",t.DORMANT="DORMANT"}(bt||(bt={})),function(t){t.WATCH_HIT_CACHE="WATCH_HIT_CACHE",t.BECKON_HIT_CACHE="BECKON_HIT_CACHE",t.RUN_HIT_CACHE="RUN_HIT_CACHE",t.READ_HIT_CACHE="READ_HIT_CACHE",t.READ_RUN="READ_RUN",t.SHORT_CIRCUIT="SHORT_CIRCUIT",t.DIRECT_RUN="DIRECT_RUN",t.BECKON_RUN="BECKON_RUN",t.CACHE_UPDATE="CACHE_UPDATE"}(St||(St={}));const Ct={listeners:{},results:{},actions:{},actionOrd:{}};let _t,mt=0;function Ot(t){if(null===t)return"(n)";const e=typeof t;if("object"!==e){if("undefined"===e)return"(u)";if("string"===e)return":"+t+";";if("boolean"===e||"number"===e)return"("+t+")"}let r="{";for(const e of Object.keys(t).sort())r+=e+Ot(t[e]);return r+"}"}function Pt(t){if(Ct.listeners.hasOwnProperty(t))for(const e of Object.keys(Ct.listeners[t]))Ct.listeners[t][e]()}function wt(t,e=!0,r=!0){e&&Ct.actionOrd.hasOwnProperty(t)&&(Ct.actionOrd[t]+=1),delete Ct.results[t],r&&Pt(t)}function kt(t,e){return t.actionOrd.hasOwnProperty(e)?t.actionOrd[e]+=1:t.actionOrd[e]=0,t.actionOrd[e]}function Et(t=null,e=[],r=""){return{payload:t,tags:e,message:r,error:!1,errorPayload:null}}function At(t=[],e="",r){return{payload:null,tags:[bt.RETURNED_ERROR,...t],message:e,error:!0,errorPayload:r}}class Rt extends Error{constructor(t,e){super(t),this.tags=e}}try{_t=new Proxy({},{get:function(t,e){throw new Error(`Pullstate: Trying to access store (${String(e)}) inside async actions without the correct usage or setup.\nIf this error occurred on the server:\n* If using run(), make use of your created instance for this request: instance.runAsyncAction()\n* If using read(), useWatch(), useBeckon() etc. - make sure you have properly set up your <PullstateProvider/>\n\nIf this error occurred on the client:\n* Make sure you have created your "pullstateCore" object with all your stores, using createPullstateCore(), and are making use of instantiate() before rendering.`)}})}catch{_t={}}const It=[!0,!1,{message:"",tags:[bt.UNFINISHED],error:!0,payload:null,errorPayload:null},!1,-1];function Ut(t,e={}){return jt((async(e,r,n)=>Et(await t(e,r,n))),e)}function jt(t,{forceContext:e=!1,shortCircuitHook:r,cacheBreakHook:n,postActionHook:i,subsetKey:c,actionId:u}={}){const l=null!=u?`_${u}`:mt++,h="undefined"==typeof window;function f(t,e){return null!=e?`${l}-c-${e}`:void 0!==c?`${l}-${Ot(c(t))}`:`${l}-${Ot(t)}`}const d=`def_wait_${f({})}`;let p={},y=0;const v={};function g(t,e,r,n){void 0!==i&&i({args:e,result:t,stores:r,context:n})}function b({args:t,cache:e,cacheBreakEnabled:r,context:s,fromListener:o,key:a,postActionEnabled:i,stores:c,customCacheBreak:u}){const l=null!=u?u:n;if(e.results.hasOwnProperty(a)){const n=p.hasOwnProperty(a)&&p[a]>2;if(!h&&!o&&r&&null!=l&&e.results[a][1]&&l({args:t,result:e.results[a][2],stores:c,timeCached:e.results[a][4]})&&!n){p.hasOwnProperty(a)?p[a]++:p[a]=1;const t=e.results[a];return delete e.results[a],{cacheBroke:!0,response:void 0,previous:t}}return n?console.error(`[${a}] Pullstate detected an infinite loop caused by cacheBreakHook()\nreturning true too often (breaking cache as soon as your action is resolving - hence\ncausing beckoned actions to run the action again) in one of your AsyncActions - Pullstate prevented\nfurther looping. Fix in your cacheBreakHook() is needed.`):p[a]=0,i&&e.results[a][1]&&!o&&g(e.results[a][2],t,c,s),{response:e.results[a],cacheBroke:!1,previous:void 0}}return{cacheBroke:!1,response:void 0,previous:void 0}}function S(e,r,n,s,o,a,i,c){return()=>t(n,s,c).then((t=>(o===r.actionOrd[e]&&(a&&g(t,n,s,i),r.results[e]=[!0,!0,t,!1,Date.now()]),t))).catch((t=>{console.error(t);const c={payload:null,errorPayload:null,error:!0,tags:[bt.THREW_ERROR],message:t.message};return o===r.actionOrd[e]&&(a&&g(c,n,s,i),r.results[e]=[!0,!0,c,!1,Date.now()]),c})).then((t=>(o===r.actionOrd[e]&&(delete r.actions[e],h||Pt(e)),t)))}function C({key:t,cache:e,initiate:n,ssr:s,args:o,stores:a,fromListener:i=!1,postActionEnabled:c=!0,cacheBreakEnabled:u=!0,holdingResult:l,customContext:f,customCacheBreak:d,holdPrevious:p}){const y=b({key:t,cache:e,args:o,stores:a,context:n?St.BECKON_HIT_CACHE:St.WATCH_HIT_CACHE,postActionEnabled:c,cacheBreakEnabled:u,fromListener:i,customCacheBreak:d});if(y.response)return y.response;if(!e.actions.hasOwnProperty(t)){const i=kt(e,t);if(!n){const r=[!1,!1,{message:"",tags:[bt.UNFINISHED],error:!0,payload:null,errorPayload:null},!1,-1];if(h||(e.results[t]=r),p){if(l){const t=[...l];return t[3]=!0,t}if(null!=y.previous){const t=[...y.previous];return t[3]=!0,t}}return r}if(void 0!==r){const n=r({args:o,stores:a});if(!1!==n)return g(n,o,a,St.SHORT_CIRCUIT),e.results[t]=[!0,!0,n,!1,Date.now()],e.results[t]}if(!s&&h||(e.actions[t]=S(t,e,o,a,i,c,St.BECKON_RUN,f)),h)return It;e.actions[t](),e.results[t]=It}if(p){if(l){const t=[...l];return t[3]=!0,t}if(null!=y.previous){const t=[...y.previous];return t[3]=!0,t}}return It}const _=(t={},{initiate:r=!1,ssr:n=!0,postActionEnabled:a=!1,cacheBreakEnabled:i=!1,holdPrevious:c=!1,dormant:u=!1,key:l,cacheBreak:d}={})=>{const p=(0,o.useRef)(),g=(0,o.useRef)("."),b=u?".":f(t,l);let S=(0,o.useRef)(-1);-1===S.current&&(S.current=y++),u||(v.hasOwnProperty(b)?v[b][S.current]=!0:v[b]={[S.current]:!0});const _=h?(0,o.useContext)(Lt)._asyncCache:Ct;let m,O;if(h||e){const t=(0,o.useContext)(Lt);m=t.stores,O=t.customContext}else m=Ht.loaded?Ht.stores:_t;if(!h){const e=()=>{v[b][S.current]&&!s()(p.current,_.results[b])&&(p.current=C({key:b,cache:_,initiate:r,ssr:n,args:t,stores:m,fromListener:!0,postActionEnabled:a,cacheBreakEnabled:i,holdingResult:void 0,customContext:O,holdPrevious:c}),w((t=>t+1)))};u||(_.listeners.hasOwnProperty(b)||(_.listeners[b]={}),_.listeners[b][S.current]=e,v[b][S.current]=!0),(0,o.useEffect)((()=>(u||(_.listeners[b][S.current]=e,v[b][S.current]=!0),()=>{u||(delete _.listeners[b][S.current],v[b][S.current]=!1)})),[b])}const[P,w]=(0,o.useState)(0);return u?(p.current=c&&p.current&&p.current[1]?p.current:[!1,!1,{message:"",tags:[bt.DORMANT],error:!0,payload:null},!1,-1],g.current="."):g.current!==b&&(null!==g.current&&v.hasOwnProperty(g.current)&&(delete _.listeners[g.current][S.current],v[g.current][S.current]=!1),g.current=b,p.current=C({key:b,cache:_,initiate:r,ssr:n,args:t,stores:m,fromListener:!1,postActionEnabled:a,cacheBreakEnabled:i,holdingResult:c&&p.current&&p.current[1]?p.current:void 0,customContext:O,customCacheBreak:"boolean"==typeof d?()=>d:d,holdPrevious:c})),p.current},m=async(t={},e={})=>{const{treatAsUpdate:n=!1,ignoreShortCircuit:s=!1,respectCache:o=!1,key:a,_asyncCache:i=Ct,_stores:c=(Ht.loaded?Ht.stores:_t),_customContext:u,cacheBreak:l}=e,h=f(t,a);if(o){const e=b({key:h,cache:i,args:t,stores:c,context:St.RUN_HIT_CACHE,postActionEnabled:!0,cacheBreakEnabled:!0,fromListener:!1,customCacheBreak:"boolean"==typeof l?()=>l:l});if(e.response&&e.response[0]){if(!e.response[1]){const t=y++;return i.listeners.hasOwnProperty(h)||(i.listeners[h]={}),new Promise((e=>{i.listeners[h][t]=()=>{const[,r,n]=i.results[h];r&&(delete i.listeners[h][t],e(n))}}))}return e.response[2]}}if(!s&&void 0!==r){const e=r({args:t,stores:c});if(!1!==e)return i.results[h]=[!0,!0,e,!1,Date.now()],g(e,t,c,St.SHORT_CIRCUIT),Pt(h),e}const[,d,p,v,C]=i.results[h]||[!1,!1,{error:!0,message:"",payload:null,tags:[bt.UNFINISHED]},!1,-1];i.results[h]=d&&n?[!0,!0,p,!0,C]:[!0,!1,{error:!0,message:"",payload:null,tags:[bt.UNFINISHED]},!1,-1];let _=kt(i,h);return i.actions[h]=S(h,i,t,c,_,!0,St.DIRECT_RUN,u),Pt(h),i.actions[h]()},O=(t={},{key:e,notify:r=!0}={})=>{wt(f(t,e),!0,r)},P=(t,e,r)=>{const{notify:n=!0,key:s}=r||{},a=f(t,s);(h?(0,o.useContext)(Lt)._asyncCache:Ct).results[a]=[!0,!0,e,!1,Date.now()],n&&Pt(a)},w=(t,e,r)=>P(t,Et(e),r),k=(t,e,r)=>{const{notify:n=!0,resetTimeCached:s=!0,runPostActionHook:a=!1,key:i}=r||{},c=f(t,i),u=h?(0,o.useContext)(Lt)._asyncCache:Ct;if(u.results.hasOwnProperty(c)&&!u.results[c][2].error){const r=u.results[c][2].payload,o={payload:ot(r,(t=>e(t,r))),error:!1,message:u.results[c][2].message,tags:u.results[c][2].tags};a&&g(o,t,Ht.loaded?Ht.stores:_t,St.CACHE_UPDATE),u.results[c]=[!0,!0,o,u.results[c][3],s?Date.now():u.results[c][4]],n&&Pt(c)}},E=(t={},e)=>{const{checkCacheBreak:r=!1,key:s}=e||{},a=f(t,s);let i=!1;const c=h?(0,o.useContext)(Lt)._asyncCache:Ct;if(c.results.hasOwnProperty(a)){if(r&&void 0!==n){const e=h?(0,o.useContext)(Lt).stores:Ht.loaded?Ht.stores:_t;n({args:t,result:c.results[a][2],stores:e,timeCached:c.results[a][4]})&&(i=!0)}const[e,s,u,l,f]=c.results[a];return{started:e,finished:s,result:u,existed:!0,cacheBreakable:i,updating:l,timeCached:f}}return{started:!1,finished:!1,result:{message:"",tags:[bt.UNFINISHED],error:!0,payload:null,errorPayload:null},updating:!1,existed:!1,cacheBreakable:i,timeCached:-1}};let A;const R=(t={},{initiate:e=!0,ssr:r=!0,postActionEnabled:n,cacheBreakEnabled:s,holdPrevious:i=!1,dormant:c=!1,key:u,onSuccess:l,cacheBreak:h}={})=>{null==n&&(n=e),null==s&&(s=e);const f=_(t,{initiate:e,ssr:r,postActionEnabled:n,cacheBreakEnabled:s,holdPrevious:i,dormant:c,key:u,cacheBreak:h}),[d,p,y,v]=f,g=p&&!y.error,b=p&&y.error;return l&&(0,o.useEffect)((()=>{g&&!c&&l(y.payload,t)}),[g]),{isStarted:d,isFinished:p,isUpdating:v,isSuccess:g,isFailure:b,isLoading:d&&(!p||v),endTags:y.tags,error:y.error,payload:y.payload,errorPayload:y.errorPayload,renderPayload:t=>y.error?a().Fragment:t(y.payload),message:y.message,raw:f,execute:e=>m(t,e),clearCached:()=>O(t),setCached:(e,r)=>{P(t,e,r)},setCachedPayload:(e,r)=>{w(t,e,r)},updateCached:(e,r)=>{k(t,e,r)}}};return{use:R,useDefer:(t={})=>{const[e,r]=(0,o.useState)((()=>({key:t.key?t.key:d,args:{}})));return{...R({},{...t,key:e.key,initiate:!1}),clearCached:()=>{O({},{key:e.key})},unwatchExecuted:()=>{r({key:d,args:{}})},setCached:(t,r={})=>{r.key=e.key,P({},t,r)},setCachedPayload:(t,r={})=>{r.key=e.key,w({},t,r)},updateCached:(t,r={})=>{r.key=e.key,k({},t,r)},execute:(n={},s)=>{var o;const a=null!==(o=t.key)&&void 0!==o?o:f(n);return a!==e.key&&r({key:a,args:n}),m(n,{...s,key:a,cacheBreak:t.cacheBreak}).then((e=>(t.clearOnSuccess&&O({},{key:a}),e)))},args:e.args,key:e.key}},read:(t={},{cacheBreakEnabled:n=!0,postActionEnabled:s=!0,key:a}={})=>{const i=f(t,a),c=h?(0,o.useContext)(Lt)._asyncCache:Ct;let u,l;if(h||e){const t=(0,o.useContext)(Lt);u=t.stores,l=t.customContext}else u=Ht.loaded?Ht.stores:_t;const d=b({key:i,cache:c,args:t,stores:u,context:St.READ_HIT_CACHE,postActionEnabled:s,cacheBreakEnabled:n,fromListener:!1});if(d.response){if(d.response[2].error)throw new Rt(d.response[2].message,d.response[2].tags);return d.response[2].payload}if(!c.actions.hasOwnProperty(i)){if(void 0!==r){const e=r({args:t,stores:u});if(!1!==e){if(g(e,t,u,St.SHORT_CIRCUIT),c.results[i]=[!0,!0,e,!1,Date.now()],e.error)throw new Rt(e.message,e.tags);return e.payload}}const e=kt(c,i);if(c.actions[i]=S(i,c,t,u,e,s,St.READ_RUN,l),h)throw new Error("Pullstate Async Action: action.read() : Resolve all async state for Suspense actions before Server-side render ( make use of instance.runAsyncAction() )");throw c.actions[i]()}if(h)throw new Error("Pullstate Async Action: action.read() : Resolve all async state for Suspense actions before Server-side render ( make use of instance.runAsyncAction() )");const p=y++;throw new Promise((t=>{c.listeners[i][p]=()=>{delete c.listeners[i][p],t()}}))},useBeckon:(t={},{ssr:e=!0,postActionEnabled:r=!0,cacheBreakEnabled:n=!0,holdPrevious:s=!1,dormant:o=!1,key:a}={})=>{const i=_(t,{initiate:!0,ssr:e,postActionEnabled:r,cacheBreakEnabled:n,holdPrevious:s,dormant:o,key:a});return[i[1],i[2],i[3]]},useWatch:_,run:m,delayedRun:(t={},{clearOldRun:e=!0,delay:r,immediateIfCached:n=!0,...s})=>{if(e&&clearTimeout(A),n){const{finished:e,cacheBreakable:r}=E(t,{checkCacheBreak:!0});if(e&&!r)return m(t,s),()=>{}}let o={cancelled:!1};return A=setTimeout((()=>{o.cancelled||m(t,s)}),r),()=>{o.cancelled=!0}},clearCache:O,clearAllCache:({notify:t=!0}={})=>{for(const e of Object.keys(Ct.actionOrd))e.startsWith(`${l}-`)&&wt(e,!0,t)},clearAllUnwatchedCache:({notify:t=!0}={})=>{for(const e of Object.keys(v))Object.values(v[e]).some((t=>t))||(delete v[e],wt(e,!1,t))},getCached:E,setCached:P,setCachedPayload:w,updateCached:k}}const Lt=a().createContext(null),Bt=({instance:t,children:e})=>a().createElement(Lt.Provider,{value:t},e);let Dt=null;const Ht={internalClientStores:!0,loaded:!1,stores:{}};class Tt{constructor(t,e={}){this.options={},null!==Dt&&console.error("Pullstate: createPullstate() - Should not be creating the core Pullstate class more than once! In order to re-use pull state, you need to call instantiate() on your already created object."),Dt=this,Ht.stores=t,Ht.loaded=!0,this.options=e}instantiate({hydrateSnapshot:t,ssr:e=!1,customContext:r}={}){if(!e){const e=new xt(Ht.stores,!1,r);return null!=t&&e.hydrateFromSnapshot(t),e.instantiateReactions(),e}const n={};for(const r of Object.keys(Ht.stores))null==t?n[r]=new dt(Ht.stores[r]._getInitialState()):t.hasOwnProperty(r)?n[r]=new dt(t.allState[r]):(n[r]=new dt(Ht.stores[r]._getInitialState()),console.warn(`Pullstate (instantiate): store [${r}] didn't hydrate any state (data was non-existent on hydration object)`)),n[r]._setInternalOptions({ssr:e,reactionCreators:Ht.stores[r]._getReactionCreators()});return new xt(n,!0,r)}useStores(){return zt()}useInstance(){return Ft()}createAsyncActionDirect(t,e={}){return Ut(t,e)}createAsyncAction(t,e={}){var r;return(null===(r=this.options.asyncActions)||void 0===r?void 0:r.defaultCachingSeconds)&&!e.cacheBreakHook&&(e.cacheBreakHook=t=>t.timeCached<Date.now()-1e3*this.options.asyncActions.defaultCachingSeconds),jt(t,e)}}class xt{constructor(t,e,r){this._ssr=!1,this._stores={},this._asyncCache={listeners:{},results:{},actions:{},actionOrd:{}},this._stores=t,this._ssr=e,this._customContext=r}getAllUnresolvedAsyncActions(){return Object.keys(this._asyncCache.actions).map((t=>this._asyncCache.actions[t]()))}instantiateReactions(){for(const t of Object.keys(this._stores))this._stores[t]._instantiateReactions()}getPullstateSnapshot(){const t={};for(const e of Object.keys(this._stores))t[e]=this._stores[e].getRawState();return{allState:t,asyncResults:this._asyncCache.results,asyncActionOrd:this._asyncCache.actionOrd}}async resolveAsyncState(){const t=this.getAllUnresolvedAsyncActions();await Promise.all(t)}hasAsyncStateToResolve(){return Object.keys(this._asyncCache.actions).length>0}get stores(){return this._stores}get customContext(){return this._customContext}async runAsyncAction(t,e={},r={}){return this._ssr&&(r._asyncCache=this._asyncCache,r._stores=this._stores,r._customContext=this._customContext),await t.run(e,r)}hydrateFromSnapshot(t){for(const e of Object.keys(this._stores))t.allState.hasOwnProperty(e)?this._stores[e]._updateStateWithoutReaction(t.allState[e]):console.warn(`${e} didn't hydrate any state (data was non-existent on hydration object)`);Ct.results=t.asyncResults||{},Ct.actionOrd=t.asyncActionOrd||{}}}function Nt(t={},e={}){return new Tt(t,e)}function zt(){return(0,o.useContext)(Lt).stores}function Ft(){return(0,o.useContext)(Lt)}var Mt;function Wt(t){if(t.type===Mt.BECKON){const e=t.action.useBeckon(t.args,t.options);return t.children(e)}const e=t.action.useWatch(t.args,t.options);return t.children(e)}function $t({store:t,paths:e,children:r}){return r(lt(t,e))}function Kt(t,{namespace:e=""}={}){var r;const n="undefined"!=typeof window?null===(r=window)||void 0===r?void 0:r.__REDUX_DEVTOOLS_EXTENSION__:void 0;if(n)for(const r of Object.keys(t)){const s=t[r],o=n.connect({name:`${e}${r}`});o.init(s.getRawState());let a=!1;s.subscribe((t=>t),(t=>{a?a=!1:o.send("Change",t)})),o.subscribe((t=>{if("DISPATCH"===t.type&&t.state){a=!0;const e=JSON.parse(t.state);s.replace(e)}}))}}!function(t){t.WATCH="watch",t.BECKON="beckon"}(Mt||(Mt={}));const Vt={};function Xt({uiBatchFunction:t}){Vt.uiBatchFunction=t}function Jt(t){if(ft.batching)throw new Error("Pullstate: Can't enact two batch() update functions at the same time-\nmake sure you are not running a batch() inside of a batch() by mistake.");ft.batching=!0;try{t()}finally{Vt.uiBatchFunction?Vt.uiBatchFunction((()=>{Object.values(ft.flushStores).forEach((t=>t.flushBatch(!0)))})):Object.values(ft.flushStores).forEach((t=>t.flushBatch(!0))),ft.flushStores={},ft.batching=!1}}}}]);